Data Science Final Project
Using News Headlines Sentiment Analysis to Predict Stock Prices
Introduction
News Headline Sentiment Analysis
Load Stock Data
Data Visualization I
Stock Pirce
Merge News Sentiment With Stock Price By Date
SVM Models
Decision Tree
Decision Tree for All the 30 Companies Together
Decision Tree for Individual Company
Data Visualization II
Topic Modeling
WordCloud
Introduction
Our project aims at investigating how major news sentiment (e.g. new financial regulations, giant companies acquisition or bankruptcy) reported by mass media can influence the volatility of stock market price in U.S., and predict stock market price change affected by important events. This model may be applied by investors, governments, banks and other sectors to evaluate the financial impacts resulting from major events in the news reports.

Data source: - 2014 - 2017 Daily News Headlines of Wall Street Journal (News on 01/01/2017: http://www.wsj.com/public/page/archive-2017-1-1.html) - Daily Dow Jones Stock Price () - Quarterly U.S. GDP (World Bank) - Monthly U.S. Interest Rate (https://fred.stlouisfed.org/tags/series?t=interest+rate%3Bmonthly%3Busa) - Daily NASDQ (https://www.nasdaq.com/aspx/DailyMarketStatistics.aspx) - Monthly U.S. Unemployment Rate (https://data.bls.gov/timeseries/LNS14000000) - Quarterly Company’s Total Assets (https://ycharts.com/dashboard/)

Methods: We quantify the news headlines through calculating the daily average sentiment of key words and then merge the news sentiment with stock prices and macroeconomic indexes on the daily base. We mainly use SVM and decision tree to conduct the classification for the direction of stock price change. To evaluate how the news sentiment can influence the percentage change of stock price, we applied the linear regression for the Dow Jones price of 30 companies. Afterwards, LDA is utilized to categorize all the key words into different topics for us to detect the patterns of the news sentiment.

Conclusion: We compared the SVM the Decision Tree model and we found the accuracy of the Decision Tree model is around 75% percent. News sentiment is the most important among all input features. In addition, at the firm level, PG, PFE, NKE are mostly influenced by average news sentiment.

Future work: The topic modeling can be explored more by connecting different topic groups with the change stock price. The percentage change of the stock price has not yet predicted within our analysis. We can evaluate the impacts from news sentiment on the percentage change of the stock price through other machine learning methods in the future.

News Headline Sentiment Analysis
Below is the sentiment analysis for the news headlines. We first collect the key words from the news headlines on the Wall Street Journal by day and clean the data through removing the stop words and blank tokens. According to the sentiment dictionary, all the key words are identified as “positive” or “negative”. After assigning the “positive” as 1 and “negative” as 0, we can calculate the daily average sentiment of news. From 2014 to 2017, the overall average sentiment of all the news is around 0.46.

knitr::opts_chunk$set(echo = TRUE)

#####################################
# News Headline Sentiment Analysis  #
#####################################

library(rio)
github.url <- "https://github.com/VivianSihanZHENG/Final-Project/blob/master/"
file.url <- "rawnews.RData?raw=true" 
news <- import(paste0(github.url, file.url)) 

library(tidytext) #for easy text manipulation
library(SnowballC) #for stemming words
library(NLP)  
library(tm) 
library(dplyr) 

# Get a sentiment dictionary 
dict <- get_sentiments("bing") 

# Parse your text
# Create date formate 
toks <- news %>% 
  unnest_tokens(word, abstract)  %>% 
  mutate(word = wordStem(word)) 

toks$date <- as.Date(toks$date,"%Y-%m-%d") 

#Remove stopwords and blank tokens
data(stop_words)  
toks <- toks %>% 
  anti_join(stop_words) 

#Get Average Sentiment
toks <- toks %>% inner_join(dict) 

senti_character <- as.character(toks$sentiment)
senti_character <- gsub("negative","0", senti_character)  
senti_character <- gsub("positive","1", senti_character)  
toks$senti <- as.numeric(senti_character) 

senti_bydate <- aggregate(toks$senti, by = list(date = toks$date), FUN = mean) 
colnames(senti_bydate)[which(names(senti_bydate) == "x")] <- "avg.senti"
Load Stock Data
The Dow Jones industrial average (DJIA) includes 30 of America’s largest companies from a wide range of industries. Thus, we loaded these 30 companies’ daily stock price information, including opening and closing price. The direction and percentage of change are also included in the data frame to evaluate the vitality of stock price.

###################
##Load stock data##
###################

#Set Working Directory to Locate the 30 Companies' Data
##Need data path change 
setwd("/Users/shirleyfu/Desktop/Dow Jones") 

#Get the File List
##Need data path change
files <- list.files(path = "/Users/shirleyfu/Desktop/Dow Jones", recursive = TRUE,
                    pattern = "\\.csv$", full.names = FALSE)

# Loop the data frame consisting all 30 companies' data
data2=lapply(files, read.csv, header=TRUE, sep=",")
data_rbind <- do.call("rbind", data2) 

#Change the data type of Date as Date
data_rbind$date <- as.Date(data_rbind$date, format = "%Y-%m-%d")

#Get a new column of Year & Month so that we can subset the data for Year 2017
data_rbind$Year <- as.numeric(format(data_rbind$date, "%Y"))
data_rbind$Month <- as.numeric(format(data_rbind$date, "%m"))

#Generate a new data frame of year 2015-2017
data_4yrs <- subset(data_rbind, data_rbind$Year == 2017 | data_rbind$Year == 2016 | data_rbind$Year == 2015 | data_rbind$Year == 2014) 


#Create a new column of the status of price change, using open price
data_4yrs$ChangeOpening <- NA
data_4yrs$ChangeClose <- NA
data_4yrs$pctopen <- NA
data_4yrs$pctclose <- NA


firm_total <- data.frame(date = as.Date(NA),
                         open = NA,
                         close = NA,
                         name = NA,
                         ChangeOpening = NA,
                         ChangeClose = NA,
                         pctopen = NA,
                         pctclose = NA)  


#calculate opening price change 
firmlist <- unique(data_4yrs$Name) 

for (i in firmlist){ 
  firm <- data_4yrs[data_4yrs$Name == i, c("date","open","close","ChangeOpening","ChangeClose","pctopen","pctclose")] 
  
  #open price change 
  for (j in 2:nrow(firm)){ 
    if (firm$open[j] > firm$open[j-1]){
      firm$ChangeOpening[j-1] <- "increase" 
    } else if (firm$open[j] <= firm$open[j-1]){
      firm$ChangeOpening[j-1] <- "decrease"
    }
  }
  
  #close price change 
  for (j in 2:nrow(firm)){ 
    if (firm$close[j] > firm$close[(j-1)]){
      firm$ChangeClose[j] <- "increase"
    } else if (firm$close[j] <= firm$close[j-1]){
      firm$ChangeClose[j] <- "decrease"
    }
  } 
  
  #percentage change 
  for (j in 2:nrow(firm)){ 
    firm$pctopen[j-1] <- (firm$open[j] - firm$open[j-1])/firm$open[j-1] *100
    firm$pctclose[j] <- (firm$close[j] - firm$close[j-1])/firm$close[j-1] *100
  }
  
  firm$name <- i 
  firm_total <- rbind(firm_total, firm) 
} 

firm_total <- firm_total[-1,]
Data Visualization I
Stock Pirce
Below is the data visualization of the stock price change of 30 companies from 2014 to 2017.

#######################
##Line Graph 30 Firms##
#######################

#2014-17 Stock Open Price
library(ggplot2)

ggplot(data = firm_total)+ 
  geom_line(mapping = aes(x=date,y=open),
                                     color="gold4")+
  facet_wrap(~name,ncol=6)+ 
  theme(strip.background = element_blank(),
        strip.text.x = element_text(size = 10),
        axis.title.x=element_blank()) + 
  #scale_x_continuous(breaks = c(2015, 2018))+ 
  labs(y = "Firm Open Price", caption = "Kaggle") +
  ggtitle("30 Firms Open Price from 2014-2017") +
  theme(plot.title = element_text(hjust = 0.5))


#2014-17 Stock Close Price

ggplot(data = firm_total)+ 
  geom_line(mapping = aes(x=date,y=close),
            color="gold4")+
  facet_wrap(~name,ncol=6)+ 
  theme(strip.background = element_blank(),
        strip.text.x = element_text(size = 10),
        axis.title.x=element_blank()) + 
  labs(y = "Firm Close Price", caption = "Kaggle") +
  ggtitle("30 Firms Close Price from 2014-2017") +
  theme(plot.title = element_text(hjust = 0.5))


According to the above graphs, we can find that Boeing (BA), UnitedHealth (UNH), 3M (MMM) and McDonald’s (MCD) have experienced rapid growth during this period. Goldman Sachs(GS), Chevron (CVX) and IBM (IBM) have seen more fluctuations than other companies.

Merge News Sentiment With Stock Price By Date
Below is the process to combine the news sentiment and stock price by date. We also added GDP, interest rate, NASDQ, unemployment rate and company total assets into the data frame as the control variables.

#################################################
# Merge news sentiment with stock price by date #
#################################################

sentiment_stock <- merge(senti_bydate, firm_total, by = "date", all = TRUE) 
sentiment_stock <- na.omit(sentiment_stock)
sentiment_stock$month <- as.numeric(format(sentiment_stock$date, "%m"))

sentiment_stock$ChangeOpening <- as.factor(sentiment_stock$ChangeOpening)
sentiment_stock$ChangeClose <- as.factor(sentiment_stock$ChangeClose)

sentiment_stock$quarter <- ceiling(as.numeric(sentiment_stock$month) / 3) 
sentiment_stock$year <- as.numeric(format(sentiment_stock$date, "%Y"))


#merge with GDP

#Load gdp 
library(rio)
github.url <- "https://github.com/VivianSihanZHENG/Final-Project/blob/master/"
file.url <- "gdp.xlsx?raw=true"

gdp <- import(paste0(github.url, file.url))
gdp$quarter <- gsub("Q","", gdp$quarter)
gdp <- gdp[,-3] 
gdp$quarter <- as.numeric(gdp$quarter) 
sentiment_stock <- merge(sentiment_stock, gdp, by = c("year","quarter")) 


#Interest rate
file.url <- "interest.xlsx?raw=true"
interest <- import(paste0(github.url, file.url))

colnames(interest)[which(names(interest) == "rate")] <- "interest.rate"
interest$interest.rate <- as.numeric(interest$interest.rate)
interest$year <- as.numeric(format(interest$date,"%Y"))
interest$month <- as.numeric(format(interest$date,"%m"))
interest <- interest[,-1]
sentiment_stock <- merge(sentiment_stock, interest, by = c("year","month")) 


#NASDQ
file.url <- "NASDQ.xlsx?raw=true"
NASDQ <- import(paste0(github.url, file.url))

colnames(NASDQ)[which(names(NASDQ) == "Date")] <- "date"
colnames(NASDQ)[which(names(NASDQ) == "Open")] <- "open_nasdq"
colnames(NASDQ)[which(names(NASDQ) == "Close")] <- "close_nasdq"
NASDQ <- NASDQ[,c("date", "open_nasdq","close_nasdq")]
NASDQ$date <- as.Date(NASDQ$date)
sentiment_stock <- merge(sentiment_stock, NASDQ, by = "date") 


#unemp
file.url <- "unemployment.xlsx?raw=true"
unemp <- import(paste0(github.url, file.url))

sentiment_stock$month <- as.numeric(sentiment_stock$month) 
sentiment_stock <- merge(sentiment_stock, unemp, by = c("year","month"))


#assets
file.url <- "asset.xlsx?raw=true"
asset<- import(paste0(github.url, file.url)) 
asset$name <- toupper(asset$name)
sentiment_stock <- merge(sentiment_stock, asset, by = c("year","quarter","name"))
SVM Models
Below is the SVM models that predict the change of the stock price by the news sentiments. With the control of GDP, interest rate, unemployment rate, NASDAQ and company total assets, we use the positive and negative news sentiments to predict whether the price on that day would increase or not.

###################
##SUPPORT VECTORS##
###################  
#Load svm libraries
library(e1071) 

train <- sentiment_stock[(sentiment_stock$avg.senti > 0.65 | sentiment_stock$avg.senti < 0.35), ] # only keep sentiment > 0.65 or < 0.35
train.positive <- sentiment_stock[sentiment_stock$avg.senti > 0.5, ]  # only keep positive sentiment 
train.negative <- sentiment_stock[sentiment_stock$avg.senti < 0.5, ]  # only keep negative sentiment 

subfile <- c("train","train.positive","train.negative")

#train <- sentiment_stock[sentiment_stock$year == 2015 | sentiment_stock$year == 2016, ]
#test <- sentiment_stock[sentiment_stock$year == 2017,] 


# Function that creates k folds 
  kfolds <- function(k){ 
    #
    #Desc: Assign each record to one of the k-folds 
    # 
    #Args:
    #  k = number of folds   
    # 
    #Returns:
    #  a vector of the partition assignments 
    #
    train$vec <- runif(nrow(train)) # ramdonly assign each observation with a random number 
    train$kfold <-  cut(train$vec, breaks = k, label = FALSE) # randomly assign observations into k groups according to the random numbers
    return(train) 
  } 
  train <- cbind(train, kfolds(5)) 
  colnames(train)[grep("kfolds", names(train))] <- "kfold" 
  
  kfolds <- function(k){ 
    #
    #Desc: Assign each record to one of the k-folds 
    # 
    #Args:
    #  k = number of folds   
    # 
    #Returns:
    #  a vector of the partition assignments 
    #
    train.positive$vec <- runif(nrow(train.positive)) # ramdonly assign each observation with a random number 
    train.positive$kfold <-  cut(train.positive$vec, breaks = k, label = FALSE) # randomly assign observations into k groups according to the random numbers
    return(train.positive) 
  } 
  train.positive <- cbind(train.positive, kfolds(5)) 
  colnames(train.positive)[grep("kfolds", names(train.positive))] <- "kfold" 
  

  kfolds <- function(k){ 
    #
    #Desc: Assign each record to one of the k-folds 
    # 
    #Args:
    #  k = number of folds   
    # 
    #Returns:
    #  a vector of the partition assignments 
    #
    train.negative$vec <- runif(nrow(train.negative)) # ramdonly assign each observation with a random number 
    train.negative$kfold <-  cut(train.negative$vec, breaks = k, label = FALSE) # randomly assign observations into k groups according to the random numbers
    return(train.negative) 
  } 
  train.negative <- cbind(train.negative, kfolds(5)) 
  colnames(train.negative)[grep("kfolds", names(train.negative))] <- "kfold" 
  

#Load F1 Score
meanf1 <- function(actual, predicted){
  
  #Mean F1 score function
  #actual = a vector of actual labels
  #predicted = predicted labels
  
  classes <- unique(actual)
  results <- data.frame()
  for(k in classes){
    results <- rbind(results, 
                     data.frame(class.name = k,
                                weight = sum(actual == k)/length(actual),
                                precision = sum(predicted == k & actual == k)/sum(predicted == k), 
                                recall = sum(predicted == k & actual == k)/sum(actual == k)))
  }
  results$score <- results$weight * 2 * (results$precision * results$recall) / (results$precision + results$recall) 
  return(sum(results$score)) 
}


scores <- data.frame()  
for (i in unique(train$kfold)){
  #Fit SVM  under default assumptions -- cost = 1, gamma = 0.055
  #svm.rbf.fit <- svm(ChangeOpening ~ avg.senti + name + growth + interest.rate + unemployment + open_nasdq, 
  #                   data = train[train$folds != i, ], kernel = "radial", 
  #                   cost = 1, gamma = 0.05555) 
  
  #Tools to review output
  #print(svm.rbf.fit) 
  
  #Calibrate SVMs
  pred.test <- svm(ChangeOpening ~ avg.senti + growth + interest.rate + unemployment + open_nasdq + assets, 
                   data = train[train$kfold != i, ], kernel = "radial", cost = 1, gamma = 8) 
  print(pred.test)  
  
  #Predict
  pred.rbf <- predict(pred.test, train[train$kfold == i, ]) 
  scores <- rbind(scores, data.frame(model = "SVM", 
                                     actual = train[train$kfold == i, ]$ChangeOpening, 
                                     predicted = pred.rbf)) 
  #examine result
  table(pred.rbf) 
}
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train[train$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  2066
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train[train$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  2059
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train[train$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  2060
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train[train$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  2070
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train[train$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  2045
meanf1(scores$actual, scores$predicted) 
## [1] 0.708848
#negative sentiment 
scores.negative <- data.frame()  
for (i in unique(train.negative$kfold)){
  #Fit SVM  under default assumptions -- cost = 1, gamma = 0.055
  #svm.rbf.fit <- svm(ChangeOpening ~ avg.senti + name + growth + interest.rate + unemployment + open_nasdq, 
  #                   data = train[train$folds != i, ], kernel = "radial", 
  #                   cost = 1, gamma = 0.05555) 
  
  #Tools to review output
  #print(svm.rbf.fit) 
  
  #Calibrate SVMs
  pred.test <- svm(ChangeOpening ~ avg.senti + growth + interest.rate + unemployment + open_nasdq + assets, 
                   data = train.negative[train.negative$kfold != i, ], kernel = "radial", cost = 1, gamma = 8) 
  print(pred.test)  
  
  #Predict
  pred.rbf <- predict(pred.test, train.negative[train.negative$kfold == i, ]) 
  scores.negative <- rbind(scores.negative, data.frame(model = "SVM", 
                                            actual = train.negative[train.negative$kfold == i, ]$ChangeOpening, 
                                            predicted = pred.rbf)) 
  #examine result
  table(pred.rbf) 
}
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train.negative[train.negative$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  14110
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train.negative[train.negative$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  14080
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train.negative[train.negative$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  13998
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train.negative[train.negative$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  14042
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train.negative[train.negative$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  14011
meanf1(scores.negative$actual, scores.negative$predicted) 
## [1] 0.6415974
#positive sentiment 
scores.positive <- data.frame()  
for (i in unique(train.positive$kfold)){
  #Fit SVM  under default assumptions -- cost = 1, gamma = 0.055
  #svm.rbf.fit <- svm(ChangeOpening ~ avg.senti + name + growth + interest.rate + unemployment + open_nasdq, 
  #                   data = train[train$folds != i, ], kernel = "radial", 
  #                   cost = 1, gamma = 0.05555) 
  
  #Tools to review output
  #print(svm.rbf.fit) 
  
  #Calibrate SVMs
  pred.test <- svm(ChangeOpening ~ avg.senti + growth + interest.rate + unemployment + open_nasdq + assets, 
                   data = train.positive[train.positive$kfold != i, ], kernel = "radial", cost = 1, gamma = 8) 
  print(pred.test)  
  
  #Predict
  pred.rbf <- predict(pred.test, train.positive[train.positive$kfold == i, ]) 
  scores.positive <- rbind(scores.positive, data.frame(model = "SVM", 
                                                       actual = train.positive[train.positive$kfold == i, ]$ChangeOpening, 
                                                       predicted = pred.rbf)) 
  #examine result
  table(pred.rbf) 
}
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train.positive[train.positive$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  460
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train.positive[train.positive$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  470
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train.positive[train.positive$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  507
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train.positive[train.positive$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  483
## 
## 
## Call:
## svm(formula = ChangeOpening ~ avg.senti + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train.positive[train.positive$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  477
meanf1(scores.negative$actual, scores.negative$predicted) 
## [1] 0.6415974
#Close price 
scores.close <- data.frame() 
for (i in unique(train$kfold)){
  #Fit SVM  under default assumptions -- cost = 1, gamma = 0.055
  #svm.rbf.fit <- svm(ChangeOpening ~ avg.senti + name + growth + interest.rate + unemployment + open_nasdq, 
  #                   data = train[train$folds != i, ], kernel = "radial", 
  #                   cost = 1, gamma = 0.05555) 
  
  #Tools to review output
  #print(svm.rbf.fit) 
  
  #Calibrate SVMs
  pred.test.close <- svm(ChangeClose ~ avg.senti + growth + interest.rate + unemployment + close_nasdq + assets, 
                         data = train[train$kfold != i, ], kernel = "radial", cost = 1, gamma = 8) 
  print(pred.test.close)  
  
  #Predict
  pred.rbf.close <- predict(pred.test.close, train[train$kfold == i, ]) 
  scores.close <- rbind(scores.close, data.frame(model = "SVM", 
                                                 actual = train[train$kfold == i, ]$ChangeClose, 
                                                 predicted = pred.rbf.close)) 
  #examine result
  table(pred.rbf.close) 
}
## 
## Call:
## svm(formula = ChangeClose ~ avg.senti + growth + interest.rate + 
##     unemployment + close_nasdq + assets, data = train[train$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  2097
## 
## 
## Call:
## svm(formula = ChangeClose ~ avg.senti + growth + interest.rate + 
##     unemployment + close_nasdq + assets, data = train[train$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  2113
## 
## 
## Call:
## svm(formula = ChangeClose ~ avg.senti + growth + interest.rate + 
##     unemployment + close_nasdq + assets, data = train[train$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  2063
## 
## 
## Call:
## svm(formula = ChangeClose ~ avg.senti + growth + interest.rate + 
##     unemployment + close_nasdq + assets, data = train[train$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  2121
## 
## 
## Call:
## svm(formula = ChangeClose ~ avg.senti + growth + interest.rate + 
##     unemployment + close_nasdq + assets, data = train[train$kfold != 
##     i, ], kernel = "radial", cost = 1, gamma = 8)
## 
## 
## Parameters:
##    SVM-Type:  C-classification 
##  SVM-Kernel:  radial 
##        cost:  1 
##       gamma:  8 
## 
## Number of Support Vectors:  2091
meanf1(scores.close$actual, scores.close$predicted)
## [1] 0.6898794
The Mean F1 Score for the sentiments predication on the open price change is around 70%.

Decision Tree
Decision Tree for All the 30 Companies Together
Decision tree model is applied to predict the change of opening price of all companies. The input features of decision tree model include news sentiments, GDP, interest rate, unemployment rate, NASDAQ and company total assets.

#####################################################
###Decision Tree for All the 30 Companies Together###
#####################################################

library(rpart) 
scores2 <- data.frame() 
for (i in unique(train$kfold)){
  
  # Refit with optimal
  # cp = 0
  fit.0 <- rpart(ChangeOpening ~ avg.senti + name + growth + 
                   interest.rate + unemployment + open_nasdq + assets, 
                 method = "class", data = train[train$kfold != i, ], cp = 0)
  # printcp(fit.0)
  # Put all cp into a data frame
  fit.0.df <- as.data.frame(printcp(fit.0))
  # Find the optimal cp
  a <- min(fit.0.df$xerror)
  b <- subset(fit.0.df, xerror == a)[, 5]
  c <- a + b
  d <- max(fit.0.df$xerror[fit.0.df$xerror <= c])
  cp.opt <- max(subset(fit.0.df, xerror == d)[, 1])
  
  # Run the optimal decision tree
  fit.opt <- rpart(ChangeOpening ~ avg.senti + growth + 
                     interest.rate + unemployment + open_nasdq + assets, 
                   method = "class", data = train[train$kfold != i, ], cp = cp.opt)
  
  # Predict values for test set
  pred.opt.test <- predict(fit.opt, train[train$kfold == i, ], type='class')
  scores2 <- rbind(scores2, data.frame(model = "Decision Tree", 
                                       actual = train[train$kfold == i, ]$ChangeOpening, 
                                       predicted = pred.opt.test))
  #examine result
  #table(pred.rbf)
}
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train[train$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1449/3013 = 0.48092
## 
## n= 3013 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04934438      0   1.00000 1.00000 0.018927
## 2  0.04209800      2   0.90131 0.91994 0.018815
## 3  0.04140787      4   0.81712 0.88199 0.018722
## 4  0.02518979      5   0.77571 0.82816 0.018545
## 5  0.02380952      7   0.72533 0.80952 0.018471
## 6  0.01794341      9   0.67771 0.76329 0.018259
## 7  0.01725328     10   0.65977 0.74948 0.018188
## 8  0.01311249     11   0.64251 0.73223 0.018094
## 9  0.00966184     12   0.62940 0.69427 0.017865
## 10 0.00874166     15   0.60041 0.66805 0.017690
## 11 0.00655625     20   0.55210 0.65217 0.017576
## 12 0.00586611     22   0.53899 0.64113 0.017494
## 13 0.00552105     25   0.51967 0.63837 0.017473
## 14 0.00483092     29   0.49758 0.63630 0.017457
## 15 0.00448585     39   0.44375 0.63561 0.017452
## 16 0.00414079     41   0.43478 0.63285 0.017431
## 17 0.00345066     43   0.42650 0.62664 0.017382
## 18 0.00310559     46   0.41615 0.62250 0.017349
## 19 0.00299057     48   0.40994 0.61422 0.017282
## 20 0.00276052     51   0.40097 0.61422 0.017282
## 21 0.00241546     57   0.38371 0.60870 0.017237
## 22 0.00207039     61   0.37405 0.60801 0.017231
## 23 0.00172533     75   0.34438 0.60801 0.017231
## 24 0.00161031     77   0.34092 0.60732 0.017225
## 25 0.00138026     81   0.33402 0.61284 0.017271
## 26 0.00103520     96   0.31332 0.61215 0.017265
## 27 0.00069013    104   0.30504 0.61146 0.017260
## 28 0.00057511    115   0.29745 0.61767 0.017310
## 29 0.00034507    121   0.29400 0.62181 0.017344
## 30 0.00017253    125   0.29262 0.62940 0.017404
## 31 0.00000000    129   0.29193 0.63285 0.017431
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train[train$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1439/2971 = 0.48435
## 
## n= 2971 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.06219597      0   1.00000 1.00000 0.018930
## 2  0.02536484      2   0.87561 0.92703 0.018840
## 3  0.02084781      4   0.82488 0.84086 0.018611
## 4  0.01928423      5   0.80403 0.72967 0.018107
## 5  0.01320361     12   0.64906 0.69493 0.017899
## 6  0.01146630     13   0.63586 0.67825 0.017790
## 7  0.00868659     16   0.60111 0.65949 0.017661
## 8  0.00764420     18   0.58374 0.66018 0.017666
## 9  0.00660181     20   0.56845 0.65393 0.017621
## 10 0.00625434     22   0.55525 0.66296 0.017685
## 11 0.00555942     26   0.52953 0.66088 0.017671
## 12 0.00486449     27   0.52397 0.65393 0.017621
## 13 0.00451703     33   0.48645 0.65601 0.017636
## 14 0.00416956     39   0.45935 0.64628 0.017565
## 15 0.00393792     41   0.45101 0.64350 0.017544
## 16 0.00347464     44   0.43919 0.63794 0.017503
## 17 0.00312717     47   0.42877 0.63586 0.017487
## 18 0.00301135     50   0.41765 0.64350 0.017544
## 19 0.00277971     53   0.40862 0.64350 0.017544
## 20 0.00243224     60   0.38916 0.64003 0.017518
## 21 0.00208478     68   0.36970 0.64211 0.017534
## 22 0.00173732     69   0.36762 0.64420 0.017550
## 23 0.00138985     75   0.35719 0.64281 0.017539
## 24 0.00104239     90   0.33634 0.65115 0.017601
## 25 0.00092657     92   0.33426 0.66088 0.017671
## 26 0.00069493    101   0.32592 0.66018 0.017666
## 27 0.00057911    105   0.32314 0.66644 0.017710
## 28 0.00041696    111   0.31967 0.66921 0.017729
## 29 0.00034746    116   0.31758 0.67199 0.017748
## 30 0.00023164    128   0.31341 0.67199 0.017748
## 31 0.00011582    131   0.31272 0.67547 0.017772
## 32 0.00000000    137   0.31202 0.67686 0.017781
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train[train$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1454/2985 = 0.4871
## 
## n= 2985 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.07290234      0   1.00000 1.00000 0.018782
## 2  0.03461715      1   0.92710 0.99656 0.018780
## 3  0.02441541      4   0.82325 0.86039 0.018540
## 4  0.02338377      6   0.77442 0.81912 0.018401
## 5  0.02235213      7   0.75103 0.80674 0.018352
## 6  0.01478680     10   0.68019 0.73384 0.018008
## 7  0.01375516     12   0.65062 0.72352 0.017951
## 8  0.01237964     15   0.60935 0.70083 0.017817
## 9  0.01169188     16   0.59697 0.70289 0.017830
## 10 0.01066025     17   0.58528 0.67675 0.017664
## 11 0.00894085     19   0.56396 0.66094 0.017556
## 12 0.00859697     20   0.55502 0.65887 0.017542
## 13 0.00722146     24   0.52063 0.64099 0.017413
## 14 0.00653370     26   0.50619 0.61829 0.017239
## 15 0.00412655     34   0.44704 0.59560 0.017052
## 16 0.00378267     38   0.43054 0.59766 0.017070
## 17 0.00361073     40   0.42297 0.59766 0.017070
## 18 0.00343879     44   0.40853 0.59216 0.017023
## 19 0.00275103     49   0.39133 0.59560 0.017052
## 20 0.00240715     53   0.38033 0.59010 0.017006
## 21 0.00206327     55   0.37552 0.59560 0.017052
## 22 0.00171939     60   0.36520 0.60110 0.017099
## 23 0.00160477     62   0.36176 0.59560 0.017052
## 24 0.00154746     68   0.35213 0.59560 0.017052
## 25 0.00137552     72   0.34594 0.60729 0.017150
## 26 0.00103164     76   0.34044 0.61210 0.017189
## 27 0.00096286     78   0.33838 0.61829 0.017239
## 28 0.00091701     89   0.32737 0.61967 0.017249
## 29 0.00085970     92   0.32462 0.62311 0.017276
## 30 0.00068776     96   0.32118 0.62311 0.017276
## 31 0.00058951    111   0.31087 0.64237 0.017423
## 32 0.00034388    122   0.30193 0.64512 0.017443
## 33 0.00000000    124   0.30124 0.64993 0.017478
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train[train$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1445/2962 = 0.48785
## 
## n= 2962 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04844291      0   1.00000 1.00000 0.018826
## 2  0.03391003      1   0.95156 0.96886 0.018804
## 3  0.01384083      2   0.91765 0.82491 0.018470
## 4  0.00968858     15   0.60484 0.66851 0.017657
## 5  0.00830450     16   0.59516 0.65052 0.017530
## 6  0.00761246     17   0.58685 0.64498 0.017490
## 7  0.00692042     19   0.57163 0.65260 0.017545
## 8  0.00657439     20   0.56471 0.64775 0.017510
## 9  0.00622837     22   0.55156 0.64775 0.017510
## 10 0.00553633     25   0.53080 0.66228 0.017614
## 11 0.00536332     27   0.51972 0.65952 0.017594
## 12 0.00484429     31   0.49827 0.65675 0.017575
## 13 0.00449827     34   0.48374 0.65952 0.017594
## 14 0.00415225     36   0.47474 0.65675 0.017575
## 15 0.00346021     40   0.45536 0.64360 0.017480
## 16 0.00311419     42   0.44844 0.64637 0.017500
## 17 0.00276817     44   0.44221 0.64637 0.017500
## 18 0.00253749     49   0.42630 0.64152 0.017465
## 19 0.00207612     52   0.41869 0.64291 0.017475
## 20 0.00173010     63   0.39585 0.64913 0.017520
## 21 0.00138408     69   0.38547 0.64983 0.017525
## 22 0.00121107     78   0.37232 0.66021 0.017599
## 23 0.00115340     82   0.36747 0.66713 0.017647
## 24 0.00103806     94   0.34879 0.66090 0.017604
## 25 0.00069204    103   0.33910 0.66920 0.017661
## 26 0.00041522    124   0.32457 0.66713 0.017647
## 27 0.00034602    129   0.32249 0.67197 0.017680
## 28 0.00000000    131   0.32180 0.67682 0.017713
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train[train$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1421/2917 = 0.48714
## 
## n= 2917 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.03026038      0   1.00000 1.00000 0.018998
## 2  0.02955665      1   0.96974 0.98311 0.018987
## 3  0.01988037      2   0.94018 0.93033 0.018921
## 4  0.01454375     12   0.68754 0.79733 0.018525
## 5  0.01266714     15   0.64391 0.76847 0.018394
## 6  0.01090781     16   0.63125 0.76003 0.018353
## 7  0.00961764     18   0.60943 0.71429 0.018104
## 8  0.00914849     21   0.58058 0.72203 0.018149
## 9  0.00809289     22   0.57143 0.71780 0.018125
## 10 0.00750645     25   0.54680 0.71217 0.018092
## 11 0.00703730     28   0.52428 0.70795 0.018066
## 12 0.00562984     31   0.50317 0.67488 0.017855
## 13 0.00492611     32   0.49754 0.65799 0.017738
## 14 0.00422238     35   0.48276 0.66854 0.017812
## 15 0.00387051     38   0.47009 0.66784 0.017807
## 16 0.00351865     41   0.45742 0.66573 0.017792
## 17 0.00316678     45   0.44335 0.66643 0.017797
## 18 0.00281492     47   0.43702 0.66080 0.017758
## 19 0.00258034     57   0.40887 0.65447 0.017712
## 20 0.00246305     60   0.40113 0.65447 0.017712
## 21 0.00234577     67   0.38283 0.65447 0.017712
## 22 0.00211119     70   0.37579 0.65095 0.017687
## 23 0.00187661     77   0.36101 0.64743 0.017661
## 24 0.00175932     80   0.35538 0.64602 0.017651
## 25 0.00164204     84   0.34835 0.64602 0.017651
## 26 0.00140746     87   0.34342 0.66080 0.017758
## 27 0.00117288     94   0.33357 0.66291 0.017772
## 28 0.00105559    101   0.32442 0.66573 0.017792
## 29 0.00070373    105   0.32020 0.67277 0.017840
## 30 0.00046915    109   0.31738 0.67699 0.017869
## 31 0.00035186    112   0.31597 0.67628 0.017864
## 32 0.00000000    114   0.31527 0.67980 0.017888
meanf1(scores2$actual, scores2$predicted)
## [1] 0.7471759
#Determine which variable had the greatest influence
fit.opt$variable.importance
##    open_nasdq     avg.senti  unemployment        growth interest.rate 
##     311.49166     236.10418     146.51024      86.65032      33.46400 
##        assets 
##      30.06390
The Mean F1 Score is around 75%. Table of Importance (variable.importance) avg.senti open_nasdq unemployment growth interest.rate assets 292.096701 236.909383 113.136274 96.780953 29.321198 4.540843

Among all the inputs, news sentiment has the highest score, which means the news sentiment has significant impacts on the change of stock price.

Decision Tree for Individual Company
Decision tree model is applied to predict the change of open price of 29 companies* respectively. (The input features of decision tree model are as previous. The importance of each input features (avg.senti, company name, GDP growth, interest.rate, unemployment, open_nasdq, and companies’ total assets) is also calculated.) ) We seperately calculated each firm’s meanf1 and variable.importance. The news sentiment has the largest influence on P&G, WMT (Walmart), and BA (Boeing). These three companies’ avg.senti score is the highest among all input features. Some firms are more sensitive to news sentiment than other firms. Our model can be used in the the investment portfolio for those firms that are easily influenced by news if the accuracy of it could be improve to a higher level in the future.

*DowDuPont (DWDP)’s open price information is not complete in the data frame.

##########################################
###Decision Tree for Individual Company###
##########################################

library(rpart)
##variable importance at company level
tree.importance <- function(){
  
  results <- c()
  importance <- data.frame()
  
  scores2 <- data.frame() 
  for (i in unique(train$kfold)){
    for (j in unique(train$name)){
      
      scores2 <- data.frame() 
      train1 <- train[train$name != j, ]
      
      # Refit with optimal
      # cp = 0
      fit.0 <- rpart(ChangeOpening ~ avg.senti + name + growth + 
                       interest.rate + unemployment + open_nasdq + assets, 
                     method = "class", data = train1[train1$kfold != i, ], cp = 0)
      # printcp(fit.0)
      # Put all cp into a data frame
      fit.0.df <- as.data.frame(printcp(fit.0))
      # Find the optimal cp
      a <- min(fit.0.df$xerror)
      b <- subset(fit.0.df, xerror == a)[, 5]
      c <- a + b
      d <- max(fit.0.df$xerror[fit.0.df$xerror <= c])
      cp.opt <- max(subset(fit.0.df, xerror == d)[, 1])
      
      # Run the optimal decision tree
      fit.opt <- rpart(ChangeOpening ~ avg.senti + growth + interest.rate + 
                         unemployment + open_nasdq + assets, 
                       method = "class", data = train1[train1$kfold != i, ], cp = cp.opt)
      
      #importance <- rbind(importance, fit.opt$variable.importance)
      import <- as.data.frame(print(fit.opt$variable.importance))
      importance <- rbind(importance, import)
    }
    return(importance)
  }
}

tree.firm29 <- tree.importance()
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2913 = 0.48095
## 
## n= 2913 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05032120      0   1.00000 1.00000 0.019248
## 2  0.04175589      2   0.89936 0.95575 0.019199
## 3  0.03783012      4   0.81585 0.88651 0.019052
## 4  0.02498216      5   0.77802 0.82156 0.018834
## 5  0.02391149      7   0.72805 0.80942 0.018784
## 6  0.01784440      9   0.68023 0.76588 0.018582
## 7  0.01284797     11   0.64454 0.71877 0.018322
## 8  0.00975494     12   0.63169 0.67809 0.018060
## 9  0.00880324     15   0.60243 0.66667 0.017980
## 10 0.00678087     20   0.55389 0.65953 0.017929
## 11 0.00642398     22   0.54033 0.64597 0.017828
## 12 0.00571021     25   0.52034 0.64168 0.017795
## 13 0.00499643     28   0.50321 0.64811 0.017844
## 14 0.00428266     37   0.45325 0.65525 0.017897
## 15 0.00392577     41   0.43612 0.64954 0.017855
## 16 0.00356888     43   0.42827 0.65168 0.017871
## 17 0.00309303     44   0.42470 0.64954 0.017855
## 18 0.00285510     50   0.40614 0.64954 0.017855
## 19 0.00249822     55   0.39186 0.65096 0.017865
## 20 0.00214133     59   0.38187 0.64168 0.017795
## 21 0.00190340     68   0.36260 0.63812 0.017768
## 22 0.00166548     71   0.35689 0.63954 0.017779
## 23 0.00142755     75   0.34975 0.63954 0.017779
## 24 0.00118963     86   0.33333 0.63597 0.017751
## 25 0.00107066     89   0.32976 0.63597 0.017751
## 26 0.00071378    103   0.31406 0.63383 0.017734
## 27 0.00059481    110   0.30906 0.63812 0.017768
## 28 0.00035689    116   0.30550 0.63812 0.017768
## 29 0.00000000    120   0.30407 0.63883 0.017773
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##    287.287989    266.844724    137.180346     83.420415     25.907394 
##        assets 
##      4.223363 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2910 = 0.48144
## 
## n= 2910 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04925054      0   1.00000 1.00000 0.019239
## 2  0.04139900      2   0.90150 0.95289 0.019187
## 3  0.02640971      5   0.77373 0.87223 0.019004
## 4  0.02462527      6   0.74732 0.84868 0.018928
## 5  0.02284083      8   0.69807 0.82013 0.018822
## 6  0.01641685      9   0.67523 0.76660 0.018580
## 7  0.01142041     10   0.65882 0.73376 0.018404
## 8  0.00999286     11   0.64739 0.68594 0.018109
## 9  0.00951701     12   0.63740 0.67951 0.018065
## 10 0.00785153     15   0.60885 0.66167 0.017940
## 11 0.00678087     17   0.59315 0.63954 0.017775
## 12 0.00642398     19   0.57959 0.64454 0.017813
## 13 0.00571021     24   0.53176 0.63597 0.017747
## 14 0.00547228     27   0.51463 0.63812 0.017764
## 15 0.00499643     31   0.48465 0.63954 0.017775
## 16 0.00481799     35   0.46467 0.64097 0.017786
## 17 0.00428266     39   0.44540 0.63312 0.017725
## 18 0.00392577     42   0.43255 0.63812 0.017764
## 19 0.00356888     44   0.42470 0.62670 0.017674
## 20 0.00321199     46   0.41756 0.62384 0.017651
## 21 0.00285510     48   0.41113 0.63026 0.017702
## 22 0.00237925     50   0.40542 0.62598 0.017668
## 23 0.00214133     53   0.39829 0.61456 0.017575
## 24 0.00190340     65   0.37116 0.61527 0.017581
## 25 0.00142755     68   0.36545 0.61242 0.017557
## 26 0.00118963     76   0.35403 0.61028 0.017539
## 27 0.00107066     88   0.33976 0.61742 0.017598
## 28 0.00071378     92   0.33547 0.62313 0.017645
## 29 0.00059481    103   0.32762 0.64383 0.017807
## 30 0.00047585    109   0.32405 0.64311 0.017802
## 31 0.00023793    115   0.32120 0.64954 0.017851
## 32 0.00000000    125   0.31620 0.65667 0.017903
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##    264.821893    242.725414    145.959689     71.089889     32.603784 
##        assets 
##      2.759345 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1395/2912 = 0.47905
## 
## n= 2912 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04874552      0   1.00000 1.00000 0.019325
## 2  0.04121864      2   0.90251 0.98351 0.019309
## 3  0.03870968      4   0.82007 0.90251 0.019164
## 4  0.02580645      5   0.78136 0.83082 0.018935
## 5  0.02437276      7   0.72975 0.77993 0.018714
## 6  0.01792115      9   0.68100 0.76487 0.018638
## 7  0.01720430     10   0.66308 0.76057 0.018616
## 8  0.01362007     11   0.64588 0.74767 0.018547
## 9  0.00955795     12   0.63226 0.72401 0.018412
## 10 0.00836320     15   0.60358 0.70394 0.018288
## 11 0.00645161     20   0.55556 0.67097 0.018066
## 12 0.00609319     23   0.53548 0.64086 0.017843
## 13 0.00573477     25   0.52330 0.63082 0.017764
## 14 0.00501792     29   0.50036 0.63513 0.017798
## 15 0.00465950     37   0.45663 0.63011 0.017758
## 16 0.00430108     41   0.43799 0.62724 0.017735
## 17 0.00358423     44   0.42509 0.62222 0.017694
## 18 0.00310633     49   0.40717 0.62151 0.017688
## 19 0.00262843     52   0.39785 0.62079 0.017682
## 20 0.00215054     56   0.38638 0.60215 0.017525
## 21 0.00179211     69   0.35771 0.60645 0.017562
## 22 0.00143369     71   0.35412 0.60932 0.017587
## 23 0.00125448     84   0.33333 0.61004 0.017593
## 24 0.00107527     91   0.32330 0.61434 0.017629
## 25 0.00095579     95   0.31900 0.61434 0.017629
## 26 0.00071685     98   0.31613 0.62007 0.017677
## 27 0.00043011    107   0.30968 0.63513 0.017798
## 28 0.00035842    114   0.30466 0.64086 0.017843
## 29 0.00000000    120   0.30251 0.64158 0.017848
##     avg.senti    open_nasdq  unemployment        growth        assets 
##     314.47308     305.83511     155.23499     117.42604      41.30130 
## interest.rate 
##      39.70661 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1403/2912 = 0.4818
## 
## n= 2912 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04989309      0   1.00000 1.00000 0.019219
## 2  0.04632929      1   0.95011 1.01568 0.019227
## 3  0.03528154      2   0.90378 0.97006 0.019190
## 4  0.03421240      4   0.83321 0.93300 0.019133
## 5  0.02637206      5   0.79900 0.89594 0.019051
## 6  0.02209551      7   0.74626 0.82680 0.018830
## 7  0.01888810      8   0.72416 0.78403 0.018648
## 8  0.01781896     10   0.68639 0.77406 0.018600
## 9  0.01211689     11   0.66857 0.73272 0.018382
## 10 0.01069138     12   0.65645 0.70064 0.018188
## 11 0.00962224     13   0.64576 0.68140 0.018062
## 12 0.00926586     18   0.59301 0.67641 0.018028
## 13 0.00784034     20   0.57448 0.67213 0.017998
## 14 0.00641483     25   0.52602 0.64148 0.017774
## 15 0.00570207     26   0.51960 0.65004 0.017839
## 16 0.00534569     30   0.49679 0.64647 0.017812
## 17 0.00498931     34   0.47541 0.64718 0.017817
## 18 0.00463293     35   0.47042 0.64220 0.017779
## 19 0.00427655     37   0.46115 0.63934 0.017757
## 20 0.00392017     42   0.43977 0.64291 0.017785
## 21 0.00356379     44   0.43193 0.64505 0.017801
## 22 0.00285103     50   0.41055 0.63364 0.017713
## 23 0.00237586     52   0.40485 0.62010 0.017605
## 24 0.00213828     59   0.38774 0.61939 0.017599
## 25 0.00178190     70   0.36208 0.61511 0.017564
## 26 0.00166310     72   0.35852 0.61297 0.017546
## 27 0.00142552     75   0.35353 0.61511 0.017564
## 28 0.00071276     89   0.33357 0.62224 0.017622
## 29 0.00042766    103   0.32359 0.63079 0.017691
## 30 0.00035638    109   0.32074 0.63435 0.017719
## 31 0.00000000    115   0.31860 0.64505 0.017801
##     avg.senti    open_nasdq  unemployment        growth        assets 
##     314.46802     295.40970     173.83092     114.13858      64.59780 
## interest.rate 
##      54.35893 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1391/2900 = 0.47966
## 
## n= 2900 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04924515      0   1.00000 1.00000 0.019341
## 2  0.04133717      2   0.90151 0.99712 0.019339
## 3  0.03882099      4   0.81884 0.96693 0.019306
## 4  0.02588066      5   0.78001 0.87347 0.019101
## 5  0.02408339      7   0.72825 0.81380 0.018886
## 6  0.01869159      9   0.68009 0.78648 0.018765
## 7  0.01797268     10   0.66139 0.73616 0.018503
## 8  0.01294033     11   0.64342 0.70309 0.018303
## 9  0.00958543     12   0.63048 0.67434 0.018110
## 10 0.00718907     15   0.60173 0.63911 0.017850
## 11 0.00611071     20   0.55284 0.63408 0.017810
## 12 0.00603882     24   0.52840 0.64198 0.017872
## 13 0.00575126     29   0.49820 0.64198 0.017872
## 14 0.00503235     32   0.48095 0.63551 0.017822
## 15 0.00431344     35   0.46585 0.62401 0.017729
## 16 0.00395399     37   0.45723 0.62832 0.017764
## 17 0.00359454     42   0.43422 0.62545 0.017741
## 18 0.00323508     49   0.40906 0.62617 0.017747
## 19 0.00311526     51   0.40259 0.62473 0.017735
## 20 0.00287563     54   0.39324 0.62473 0.017735
## 21 0.00263599     56   0.38749 0.61898 0.017688
## 22 0.00251618     60   0.37599 0.62185 0.017712
## 23 0.00215672     64   0.36592 0.61179 0.017628
## 24 0.00179727     74   0.34364 0.61251 0.017634
## 25 0.00143781     76   0.34004 0.61035 0.017616
## 26 0.00107836     87   0.32279 0.62976 0.017776
## 27 0.00089863     93   0.31632 0.63336 0.017805
## 28 0.00071891     97   0.31272 0.63480 0.017816
## 29 0.00043134    109   0.30410 0.65277 0.017954
## 30 0.00035945    116   0.29978 0.66068 0.018012
## 31 0.00000000    120   0.29835 0.66068 0.018012
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##     300.60731     256.23901     113.01183     105.79992      18.57831 
##        assets 
##       2.67369 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1400/2910 = 0.4811
## 
## n= 2910 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05357143      0   1.00000 1.00000 0.019252
## 2  0.05250000      1   0.94643 0.99929 0.019252
## 3  0.03392857      3   0.84143 0.89286 0.019074
## 4  0.02785714      5   0.77357 0.84000 0.018908
## 5  0.02142857      6   0.74571 0.79714 0.018736
## 6  0.01928571      7   0.72429 0.78357 0.018674
## 7  0.01857143      9   0.68571 0.75857 0.018550
## 8  0.01785714     10   0.66714 0.74929 0.018501
## 9  0.01071429     11   0.64929 0.73286 0.018409
## 10 0.00785714     12   0.63857 0.69786 0.018197
## 11 0.00714286     19   0.57714 0.66214 0.017953
## 12 0.00607143     23   0.54357 0.65357 0.017890
## 13 0.00557143     25   0.53143 0.65286 0.017885
## 14 0.00500000     30   0.50357 0.65000 0.017863
## 15 0.00464286     32   0.49357 0.64357 0.017815
## 16 0.00428571     36   0.47500 0.63357 0.017737
## 17 0.00392857     39   0.46214 0.63214 0.017726
## 18 0.00380952     41   0.45429 0.62786 0.017692
## 19 0.00357143     44   0.44286 0.62857 0.017698
## 20 0.00285714     49   0.42500 0.62786 0.017692
## 21 0.00250000     52   0.41643 0.61786 0.017611
## 22 0.00238095     54   0.41143 0.61714 0.017605
## 23 0.00214286     61   0.39429 0.60500 0.017503
## 24 0.00142857     71   0.37286 0.60786 0.017527
## 25 0.00119048     90   0.34500 0.62143 0.017640
## 26 0.00095238     93   0.34143 0.62214 0.017646
## 27 0.00071429     97   0.33643 0.62286 0.017652
## 28 0.00047619    108   0.32857 0.63500 0.017748
## 29 0.00035714    111   0.32714 0.63357 0.017737
## 30 0.00000000    115   0.32571 0.63857 0.017776
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##     318.30112     317.18901     169.75371     121.27756      51.13437 
##        assets 
##      48.73730 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1397/2906 = 0.48073
## 
## n= 2906 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04903364      0   1.00000 1.00000 0.019280
## 2  0.04080172      2   0.90193 0.95061 0.019222
## 3  0.02648533      5   0.77452 0.88404 0.019076
## 4  0.02219041      6   0.74803 0.84180 0.018940
## 5  0.02183250      7   0.72584 0.80458 0.018793
## 6  0.01789549      9   0.68218 0.78525 0.018706
## 7  0.00954426     10   0.66428 0.71868 0.018350
## 8  0.00715820     13   0.63565 0.68719 0.018149
## 9  0.00680029     15   0.62133 0.68218 0.018116
## 10 0.00644238     20   0.57266 0.68003 0.018101
## 11 0.00601288     22   0.55977 0.67717 0.018081
## 12 0.00572656     27   0.52971 0.67144 0.018041
## 13 0.00536865     32   0.49320 0.65927 0.017954
## 14 0.00483178     34   0.48246 0.65784 0.017944
## 15 0.00465283     38   0.46314 0.64996 0.017885
## 16 0.00357910     42   0.44452 0.63994 0.017809
## 17 0.00322119     44   0.43737 0.63994 0.017809
## 18 0.00286328     51   0.41374 0.63708 0.017787
## 19 0.00250537     53   0.40802 0.63780 0.017792
## 20 0.00214746     57   0.39800 0.62634 0.017702
## 21 0.00178955     68   0.37366 0.62276 0.017673
## 22 0.00161059     74   0.36292 0.61847 0.017638
## 23 0.00143164     78   0.35648 0.62563 0.017696
## 24 0.00107373     95   0.33214 0.62419 0.017684
## 25 0.00095443     97   0.32999 0.62205 0.017667
## 26 0.00071582    103   0.32427 0.62205 0.017667
## 27 0.00047721    115   0.31568 0.63064 0.017736
## 28 0.00035791    121   0.31281 0.63278 0.017753
## 29 0.00023861    127   0.31067 0.64639 0.017858
## 30 0.00000000    130   0.30995 0.65211 0.017901
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##     334.53531     331.54706     175.31708     121.46242      58.84104 
##        assets 
##      56.17196 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1395/2908 = 0.47971
## 
## n= 2908 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04695341      0   1.00000 1.00000 0.019312
## 2  0.04336918      2   0.90609 0.97133 0.019283
## 3  0.04014337      4   0.81935 0.95771 0.019265
## 4  0.02473118      5   0.77921 0.86953 0.019061
## 5  0.02150538      7   0.72975 0.82222 0.018893
## 6  0.01792115      9   0.68674 0.77348 0.018674
## 7  0.01290323     10   0.66882 0.75125 0.018559
## 8  0.00955795     11   0.65591 0.69176 0.018202
## 9  0.00896057     19   0.57706 0.68387 0.018150
## 10 0.00716846     23   0.54050 0.66810 0.018040
## 11 0.00681004     25   0.52616 0.64158 0.017843
## 12 0.00645161     27   0.51254 0.63441 0.017787
## 13 0.00573477     31   0.48602 0.63441 0.017787
## 14 0.00501792     35   0.46308 0.62079 0.017677
## 15 0.00394265     42   0.42796 0.61290 0.017612
## 16 0.00358423     44   0.42007 0.61362 0.017618
## 17 0.00322581     45   0.41649 0.61434 0.017624
## 18 0.00286738     48   0.40573 0.61004 0.017588
## 19 0.00250896     53   0.39140 0.61075 0.017594
## 20 0.00215054     55   0.38638 0.62079 0.017677
## 21 0.00191159     75   0.34122 0.61935 0.017665
## 22 0.00143369     78   0.33548 0.62007 0.017671
## 23 0.00107527     90   0.31541 0.61792 0.017654
## 24 0.00071685     96   0.30896 0.61792 0.017654
## 25 0.00047790    114   0.29606 0.64229 0.017848
## 26 0.00035842    117   0.29462 0.64588 0.017876
## 27 0.00000000    121   0.29319 0.65663 0.017956
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##    268.847990    257.373763    109.215700     92.232187     29.643269 
##        assets 
##      3.021778 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2922 = 0.47947
## 
## n= 2922 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04817987      0   1.00000 1.00000 0.019275
## 2  0.04104211      2   0.90364 1.01071 0.019283
## 3  0.02783726      5   0.77730 0.89507 0.019097
## 4  0.02462527      6   0.74946 0.84440 0.018939
## 5  0.02212705      8   0.70021 0.82013 0.018847
## 6  0.01784440      9   0.67809 0.79443 0.018737
## 7  0.00927909     10   0.66024 0.70164 0.018230
## 8  0.00678087     15   0.61385 0.66453 0.017978
## 9  0.00642398     20   0.56460 0.64811 0.017856
## 10 0.00594813     21   0.55817 0.65596 0.017915
## 11 0.00535332     25   0.52677 0.64811 0.017856
## 12 0.00499643     29   0.50535 0.65025 0.017873
## 13 0.00481799     30   0.50036 0.64954 0.017867
## 14 0.00463954     34   0.48108 0.64383 0.017824
## 15 0.00392577     38   0.46253 0.64739 0.017851
## 16 0.00356888     41   0.44754 0.65310 0.017894
## 17 0.00321199     43   0.44040 0.64882 0.017862
## 18 0.00309303     47   0.42755 0.64954 0.017867
## 19 0.00285510     50   0.41827 0.64954 0.017867
## 20 0.00249822     52   0.41256 0.64668 0.017846
## 21 0.00237925     54   0.40757 0.64454 0.017829
## 22 0.00214133     57   0.40043 0.62670 0.017689
## 23 0.00190340     74   0.36046 0.62741 0.017695
## 24 0.00142755     77   0.35475 0.62598 0.017683
## 25 0.00118963     83   0.34618 0.63455 0.017752
## 26 0.00107066     86   0.34261 0.63597 0.017763
## 27 0.00095170     94   0.33405 0.63526 0.017757
## 28 0.00071378    102   0.32620 0.63812 0.017780
## 29 0.00059481    114   0.31763 0.65453 0.017905
## 30 0.00017844    120   0.31406 0.66381 0.017972
## 31 0.00000000    124   0.31335 0.66310 0.017967
##     avg.senti    open_nasdq  unemployment        growth        assets 
##     320.89773     307.45067     165.97518      99.35897      50.73970 
## interest.rate 
##      48.68322 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1397/2912 = 0.47974
## 
## n= 2912 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04974946      0   1.00000 1.00000 0.019298
## 2  0.04187545      2   0.90050 0.92627 0.019194
## 3  0.04151754      4   0.81675 0.92627 0.019194
## 4  0.02576951      5   0.77523 0.86328 0.019027
## 5  0.02505369      7   0.72369 0.83035 0.018911
## 6  0.01861131      9   0.67359 0.78883 0.018734
## 7  0.01360057     11   0.63636 0.76951 0.018641
## 8  0.00954426     12   0.62276 0.70437 0.018271
## 9  0.00715820     15   0.59413 0.67287 0.018060
## 10 0.00680029     20   0.54545 0.65140 0.017904
## 11 0.00608447     22   0.53185 0.64281 0.017839
## 12 0.00536865     24   0.51969 0.62634 0.017710
## 13 0.00524934     26   0.50895 0.63422 0.017772
## 14 0.00501074     30   0.48676 0.62992 0.017738
## 15 0.00465283     35   0.46170 0.62992 0.017738
## 16 0.00429492     39   0.44309 0.63207 0.017755
## 17 0.00393701     41   0.43450 0.63278 0.017761
## 18 0.00357910     47   0.41088 0.64352 0.017845
## 19 0.00322119     51   0.39656 0.64424 0.017850
## 20 0.00262467     53   0.39012 0.62491 0.017698
## 21 0.00214746     57   0.37867 0.63135 0.017750
## 22 0.00190885     66   0.35863 0.62849 0.017727
## 23 0.00143164     69   0.35290 0.62777 0.017721
## 24 0.00125268     81   0.33429 0.63135 0.017750
## 25 0.00119303     87   0.32498 0.62992 0.017738
## 26 0.00107373     91   0.31926 0.62921 0.017733
## 27 0.00071582    101   0.30852 0.63708 0.017795
## 28 0.00059652    111   0.30136 0.64066 0.017823
## 29 0.00040904    117   0.29778 0.64710 0.017872
## 30 0.00035791    124   0.29492 0.65569 0.017936
## 31 0.00017895    130   0.29277 0.65712 0.017947
## 32 0.00000000    134   0.29205 0.66070 0.017973
##     avg.senti    open_nasdq  unemployment        growth        assets 
##     346.23550     308.52404     127.84769     123.45706      72.93500 
## interest.rate 
##      31.92209 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1396/2905 = 0.48055
## 
## n= 2905 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04835244      0   1.00000 1.00000 0.019290
## 2  0.04226361      2   0.90330 1.00645 0.019294
## 3  0.02793696      5   0.77364 0.87679 0.019064
## 4  0.02292264      6   0.74570 0.85960 0.019011
## 5  0.02256447      7   0.72278 0.82880 0.018901
## 6  0.01790831      9   0.67765 0.74570 0.018514
## 7  0.00978988     10   0.65974 0.72421 0.018391
## 8  0.00955110     13   0.63037 0.70201 0.018254
## 9  0.00680516     18   0.58023 0.64971 0.017891
## 10 0.00601719     20   0.56662 0.62249 0.017678
## 11 0.00573066     25   0.53653 0.62249 0.017678
## 12 0.00537249     29   0.51361 0.61605 0.017625
## 13 0.00525310     31   0.50287 0.61605 0.017625
## 14 0.00483524     35   0.47350 0.61819 0.017643
## 15 0.00429799     39   0.45415 0.61819 0.017643
## 16 0.00358166     40   0.44986 0.60673 0.017547
## 17 0.00322350     42   0.44269 0.61103 0.017583
## 18 0.00310411     47   0.42550 0.61318 0.017601
## 19 0.00286533     50   0.41619 0.61318 0.017601
## 20 0.00250716     57   0.39613 0.61461 0.017613
## 21 0.00214900     61   0.38610 0.62607 0.017707
## 22 0.00191022     71   0.36390 0.62822 0.017725
## 23 0.00143266     74   0.35817 0.61963 0.017655
## 24 0.00107450     86   0.33954 0.62607 0.017707
## 25 0.00071633     93   0.33166 0.63897 0.017809
## 26 0.00042980    107   0.32163 0.64542 0.017859
## 27 0.00035817    114   0.31734 0.65401 0.017923
## 28 0.00000000    116   0.31662 0.65473 0.017929
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##     221.16027     167.95600      81.59602      63.00321      23.58158 
##        assets 
##       1.94512 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1406/2911 = 0.483
## 
## n= 2911 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05547653      0   1.00000 1.00000 0.019176
## 2  0.04694168      1   0.94452 0.97155 0.019151
## 3  0.04196302      2   0.89758 0.94737 0.019118
## 4  0.03058321      5   0.77027 0.86771 0.018934
## 5  0.02204836      6   0.73969 0.80441 0.018704
## 6  0.02133713      8   0.69559 0.78094 0.018599
## 7  0.01778094      9   0.67425 0.77240 0.018558
## 8  0.00995733     10   0.65647 0.73826 0.018381
## 9  0.00675676     13   0.62660 0.66999 0.017953
## 10 0.00640114     17   0.59957 0.64296 0.017756
## 11 0.00533428     22   0.55192 0.64509 0.017772
## 12 0.00497866     24   0.54125 0.63300 0.017680
## 13 0.00480085     35   0.47368 0.63229 0.017674
## 14 0.00450450     39   0.45448 0.63158 0.017668
## 15 0.00426743     42   0.44097 0.63158 0.017668
## 16 0.00355619     43   0.43670 0.65149 0.017820
## 17 0.00320057     44   0.43314 0.65718 0.017862
## 18 0.00284495     46   0.42674 0.65505 0.017846
## 19 0.00248933     58   0.39118 0.65718 0.017862
## 20 0.00213371     64   0.37624 0.64083 0.017740
## 21 0.00189663     69   0.36558 0.63869 0.017724
## 22 0.00177809     72   0.35989 0.63585 0.017702
## 23 0.00165955     75   0.35349 0.63585 0.017702
## 24 0.00142248     79   0.34637 0.62802 0.017640
## 25 0.00106686     91   0.32930 0.62660 0.017629
## 26 0.00071124     93   0.32717 0.63371 0.017685
## 27 0.00047416    102   0.32077 0.64367 0.017762
## 28 0.00035562    111   0.31650 0.64011 0.017735
## 29 0.00023708    117   0.31437 0.64936 0.017804
## 30 0.00000000    127   0.30939 0.65292 0.017831
##     avg.senti    open_nasdq  unemployment        growth        assets 
##     351.23437     340.23926     173.74324     123.50892      58.61963 
## interest.rate 
##      58.40292 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2908 = 0.48177
## 
## n= 2908 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04996431      0   1.00000 1.00000 0.019233
## 2  0.04925054      1   0.95004 1.02641 0.019244
## 3  0.03069236      2   0.90079 0.97430 0.019209
## 4  0.02902689      3   0.87009 0.82512 0.018837
## 5  0.02177016      6   0.78301 0.78801 0.018680
## 6  0.01927195      8   0.73947 0.73305 0.018397
## 7  0.01784440     10   0.70093 0.72377 0.018343
## 8  0.01391863     12   0.66524 0.71163 0.018270
## 9  0.01070664     14   0.63740 0.69593 0.018171
## 10 0.00927909     16   0.61599 0.68522 0.018101
## 11 0.00832739     18   0.59743 0.67595 0.018038
## 12 0.00642398     23   0.55032 0.65810 0.017911
## 13 0.00535332     27   0.52177 0.63597 0.017744
## 14 0.00499643     29   0.51106 0.63526 0.017739
## 15 0.00428266     40   0.45111 0.62741 0.017677
## 16 0.00380680     44   0.43398 0.62099 0.017625
## 17 0.00356888     47   0.42256 0.61956 0.017613
## 18 0.00321199     51   0.40828 0.62099 0.017625
## 19 0.00285510     53   0.40186 0.61599 0.017584
## 20 0.00237925     55   0.39615 0.61313 0.017560
## 21 0.00214133     58   0.38901 0.61884 0.017607
## 22 0.00178444     65   0.37330 0.62170 0.017631
## 23 0.00166548     68   0.36759 0.62027 0.017619
## 24 0.00142755     72   0.36046 0.62099 0.017625
## 25 0.00118963     83   0.34475 0.62027 0.017619
## 26 0.00107066     86   0.34118 0.61813 0.017602
## 27 0.00083274     88   0.33904 0.62241 0.017636
## 28 0.00071378     96   0.33191 0.61813 0.017602
## 29 0.00035689    108   0.32334 0.62884 0.017688
## 30 0.00000000    120   0.31906 0.62670 0.017671
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##     348.87352     317.64857     170.06281     150.96993      73.81351 
##        assets 
##      69.72253 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1394/2903 = 0.48019
## 
## n= 2903 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04842181      0   1.00000 1.00000 0.019310
## 2  0.04304161      2   0.90316 0.96700 0.019276
## 3  0.04088953      4   0.81707 0.91607 0.019185
## 4  0.02797704      5   0.77618 0.90459 0.019158
## 5  0.02259684      6   0.74821 0.79053 0.018757
## 6  0.02080344      8   0.70301 0.76040 0.018609
## 7  0.01793400      9   0.68221 0.74247 0.018513
## 8  0.00932568     10   0.66428 0.69369 0.018217
## 9  0.00908656     12   0.64562 0.69727 0.018241
## 10 0.00836920     15   0.61836 0.68867 0.018184
## 11 0.00789096     19   0.58178 0.68436 0.018155
## 12 0.00717360     21   0.56600 0.68364 0.018150
## 13 0.00681492     25   0.53228 0.68436 0.018155
## 14 0.00645624     27   0.51865 0.66714 0.018035
## 15 0.00609756     28   0.51220 0.65782 0.017968
## 16 0.00502152     30   0.50000 0.64562 0.017876
## 17 0.00466284     34   0.47991 0.64060 0.017838
## 18 0.00430416     36   0.47059 0.64060 0.017838
## 19 0.00394548     40   0.45337 0.64204 0.017849
## 20 0.00358680     42   0.44548 0.63773 0.017815
## 21 0.00322812     46   0.43113 0.63630 0.017804
## 22 0.00310856     50   0.41822 0.63630 0.017804
## 23 0.00286944     53   0.40890 0.63630 0.017804
## 24 0.00251076     54   0.40603 0.64132 0.017843
## 25 0.00239120     61   0.38666 0.64060 0.017838
## 26 0.00215208     65   0.37661 0.62554 0.017718
## 27 0.00179340     81   0.33931 0.61765 0.017654
## 28 0.00143472     83   0.33572 0.61836 0.017660
## 29 0.00119560     90   0.32568 0.62410 0.017707
## 30 0.00107604     93   0.32209 0.62554 0.017718
## 31 0.00095648     99   0.31564 0.63199 0.017770
## 32 0.00071736    102   0.31277 0.63199 0.017770
## 33 0.00053802    116   0.30273 0.63199 0.017770
## 34 0.00047824    120   0.30057 0.63989 0.017832
## 35 0.00043042    123   0.29914 0.64132 0.017843
## 36 0.00035868    130   0.29412 0.64347 0.017860
## 37 0.00023912    132   0.29340 0.64347 0.017860
## 38 0.00000000    135   0.29268 0.64204 0.017849
##    open_nasdq     avg.senti  unemployment        growth        assets 
##     316.63106     289.06751     152.54495      95.15007      48.48993 
## interest.rate 
##      48.39858 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2909 = 0.48161
## 
## n= 2909 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05258149      0   1.00000 1.00000 0.019236
## 2  0.04068522      3   0.84226 0.91649 0.019116
## 3  0.01784440      4   0.80157 0.84154 0.018900
## 4  0.01237212      5   0.78373 0.75732 0.018531
## 5  0.01094456      9   0.73162 0.73091 0.018386
## 6  0.00856531     14   0.64525 0.67809 0.018054
## 7  0.00832739     16   0.62812 0.66952 0.017994
## 8  0.00713776     21   0.58101 0.66024 0.017928
## 9  0.00678087     23   0.56674 0.64954 0.017849
## 10 0.00606709     25   0.55318 0.64597 0.017822
## 11 0.00556745     29   0.52891 0.65096 0.017860
## 12 0.00535332     35   0.49465 0.64954 0.017849
## 13 0.00499643     37   0.48394 0.64954 0.017849
## 14 0.00475851     38   0.47894 0.64954 0.017849
## 15 0.00428266     41   0.46467 0.64668 0.017828
## 16 0.00380680     44   0.45182 0.64168 0.017790
## 17 0.00356888     47   0.44040 0.62955 0.017695
## 18 0.00285510     52   0.42256 0.63455 0.017734
## 19 0.00261718     53   0.41970 0.62527 0.017661
## 20 0.00214133     56   0.41185 0.63169 0.017712
## 21 0.00166548     67   0.38544 0.62812 0.017684
## 22 0.00142755     74   0.37330 0.63740 0.017757
## 23 0.00107066     91   0.34832 0.64097 0.017784
## 24 0.00071378    107   0.33048 0.64311 0.017801
## 25 0.00035689    116   0.32405 0.65453 0.017886
## 26 0.00017844    120   0.32263 0.66952 0.017994
## 27 0.00000000    124   0.32191 0.66952 0.017994
##    open_nasdq     avg.senti  unemployment        growth interest.rate 
##    322.199218    230.084083    137.851485    125.760345     25.833422 
##        assets 
##      9.002192 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1399/2910 = 0.48076
## 
## n= 2910 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05289492      0   1.00000 1.00000 0.019265
## 2  0.04479390      1   0.94711 0.96855 0.019234
## 3  0.03859900      4   0.81272 0.94139 0.019193
## 4  0.03002144      5   0.77412 0.88349 0.019060
## 5  0.02394568      6   0.74410 0.80843 0.018796
## 6  0.02001430      8   0.69621 0.78556 0.018694
## 7  0.01786991      9   0.67620 0.77913 0.018663
## 8  0.00953062     10   0.65833 0.73195 0.018414
## 9  0.00822016     13   0.62974 0.68978 0.018153
## 10 0.00679056     18   0.57970 0.65904 0.017939
## 11 0.00643317     20   0.56612 0.65475 0.017908
## 12 0.00571837     24   0.53252 0.65118 0.017881
## 13 0.00500357     27   0.51537 0.64403 0.017827
## 14 0.00428878     36   0.46605 0.63402 0.017750
## 15 0.00393138     38   0.45747 0.62902 0.017710
## 16 0.00357398     40   0.44961 0.61615 0.017606
## 17 0.00321658     44   0.43531 0.61687 0.017612
## 18 0.00309745     46   0.42888 0.61472 0.017594
## 19 0.00285919     49   0.41959 0.61472 0.017594
## 20 0.00250179     52   0.41101 0.60972 0.017552
## 21 0.00238265     62   0.38528 0.61115 0.017564
## 22 0.00214439     66   0.37527 0.60400 0.017503
## 23 0.00142959     78   0.34739 0.60114 0.017479
## 24 0.00107219     86   0.33595 0.61115 0.017564
## 25 0.00095306     95   0.32380 0.60329 0.017497
## 26 0.00071480     98   0.32094 0.61115 0.017564
## 27 0.00047653    111   0.31165 0.61401 0.017588
## 28 0.00042888    114   0.31022 0.61687 0.017612
## 29 0.00035740    122   0.30450 0.62974 0.017716
## 30 0.00017870    130   0.30164 0.63331 0.017744
## 31 0.00000000    134   0.30093 0.63331 0.017744
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##    277.527829    263.935935    125.739917     85.210357     35.906274 
##        assets 
##      2.531936 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2896 = 0.48377
## 
## n= 2896 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05638829      0   1.00000 1.00000 0.019196
## 2  0.04354033      1   0.94361 0.97645 0.019176
## 3  0.03426124      2   0.90007 0.94290 0.019132
## 4  0.02831311      3   0.86581 0.82227 0.018800
## 5  0.02212705      6   0.78087 0.79800 0.018700
## 6  0.01820128      8   0.73662 0.79086 0.018669
## 7  0.01784440     10   0.70021 0.77088 0.018575
## 8  0.01641685     11   0.68237 0.76660 0.018554
## 9  0.01427552     12   0.66595 0.76303 0.018536
## 10 0.01284797     14   0.63740 0.73448 0.018384
## 11 0.00999286     15   0.62455 0.71163 0.018250
## 12 0.00963597     16   0.61456 0.69094 0.018120
## 13 0.00832739     18   0.59529 0.67809 0.018034
## 14 0.00618606     23   0.54818 0.66738 0.017960
## 15 0.00571021     27   0.52320 0.64882 0.017826
## 16 0.00535332     31   0.50036 0.64668 0.017810
## 17 0.00499643     35   0.47395 0.64597 0.017804
## 18 0.00392577     40   0.44897 0.64597 0.017804
## 19 0.00380680     44   0.43326 0.63526 0.017722
## 20 0.00356888     47   0.42184 0.63883 0.017750
## 21 0.00321199     48   0.41827 0.63169 0.017695
## 22 0.00285510     52   0.40542 0.63026 0.017683
## 23 0.00237925     54   0.39971 0.63169 0.017695
## 24 0.00214133     57   0.39258 0.62313 0.017627
## 25 0.00190340     67   0.36902 0.62455 0.017638
## 26 0.00178444     70   0.36331 0.62241 0.017621
## 27 0.00142755     72   0.35974 0.62241 0.017621
## 28 0.00107066     85   0.33833 0.62527 0.017644
## 29 0.00083274     87   0.33619 0.63883 0.017750
## 30 0.00071378     95   0.32905 0.64882 0.017826
## 31 0.00035689    106   0.32120 0.65382 0.017863
## 32 0.00000000    118   0.31692 0.65953 0.017904
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##     290.49316     270.57326     136.67555     102.50418      59.76481 
##        assets 
##       4.19976 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1407/2909 = 0.48367
## 
## n= 2909 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05472637      0   1.00000 1.00000 0.019156
## 2  0.05188344      1   0.94527 1.01421 0.019163
## 3  0.03411514      3   0.84151 0.93248 0.019075
## 4  0.02558635      5   0.77328 0.81876 0.018748
## 5  0.02132196      6   0.74769 0.79886 0.018665
## 6  0.01966359      7   0.72637 0.78749 0.018615
## 7  0.01776830     10   0.66738 0.76759 0.018521
## 8  0.00888415     11   0.64961 0.70647 0.018181
## 9  0.00805496     13   0.63184 0.67733 0.017991
## 10 0.00710732     18   0.58493 0.64179 0.017735
## 11 0.00615968     19   0.57783 0.62260 0.017586
## 12 0.00604122     23   0.54869 0.61976 0.017563
## 13 0.00533049     27   0.52452 0.62047 0.017568
## 14 0.00497512     29   0.51386 0.61834 0.017551
## 15 0.00426439     37   0.46837 0.60341 0.017427
## 16 0.00390903     40   0.45487 0.60341 0.017427
## 17 0.00379057     42   0.44705 0.60910 0.017475
## 18 0.00355366     45   0.43568 0.60910 0.017475
## 19 0.00248756     49   0.42146 0.60554 0.017445
## 20 0.00236911     55   0.40654 0.60697 0.017457
## 21 0.00213220     58   0.39943 0.60270 0.017421
## 22 0.00177683     71   0.37171 0.59844 0.017384
## 23 0.00165837     73   0.36816 0.59986 0.017397
## 24 0.00142146     77   0.36105 0.61478 0.017522
## 25 0.00118455     93   0.33760 0.61976 0.017563
## 26 0.00071073     96   0.33404 0.62402 0.017597
## 27 0.00053305    105   0.32765 0.64037 0.017725
## 28 0.00035537    113   0.32338 0.64321 0.017746
## 29 0.00000000    117   0.32196 0.65174 0.017810
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##     292.79834     279.68926     145.86957      97.62263      42.93637 
##        assets 
##      16.81302 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1402/2907 = 0.48228
## 
## n= 2907 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05349501      0   1.00000 1.00000 0.019216
## 2  0.04493581      1   0.94650 0.97860 0.019198
## 3  0.04386591      2   0.90157 0.94151 0.019147
## 4  0.02496434      5   0.76890 0.82454 0.018821
## 5  0.02139800      7   0.71897 0.76605 0.018561
## 6  0.01854494      9   0.67618 0.75107 0.018484
## 7  0.01640514     10   0.65763 0.72183 0.018320
## 8  0.01283880     11   0.64123 0.70756 0.018233
## 9  0.00927247     12   0.62839 0.68188 0.018067
## 10 0.00713267     15   0.60057 0.64051 0.017769
## 11 0.00606277     22   0.53709 0.64051 0.017769
## 12 0.00570613     24   0.52496 0.62553 0.017651
## 13 0.00534950     26   0.51355 0.61626 0.017576
## 14 0.00499287     32   0.47860 0.61626 0.017576
## 15 0.00392297     41   0.43153 0.60628 0.017493
## 16 0.00356633     43   0.42368 0.59344 0.017382
## 17 0.00309082     45   0.41655 0.59486 0.017395
## 18 0.00285307     48   0.40728 0.59058 0.017357
## 19 0.00249643     57   0.38017 0.59272 0.017376
## 20 0.00213980     61   0.37019 0.59700 0.017413
## 21 0.00178317     68   0.35449 0.58488 0.017306
## 22 0.00166429     70   0.35093 0.58488 0.017306
## 23 0.00142653     77   0.33880 0.59415 0.017388
## 24 0.00118878     86   0.32525 0.59272 0.017376
## 25 0.00106990     90   0.31954 0.59986 0.017438
## 26 0.00071327    100   0.30884 0.60485 0.017481
## 27 0.00047551    111   0.30100 0.62553 0.017651
## 28 0.00035663    114   0.29957 0.62482 0.017646
## 29 0.00023776    118   0.29815 0.62625 0.017657
## 30 0.00017832    121   0.29743 0.62839 0.017674
## 31 0.00000000    125   0.29672 0.62981 0.017685
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##     316.85723     314.12448     152.05047     125.45300      37.60358 
##        assets 
##      37.40022 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1398/2910 = 0.48041
## 
## n= 2910 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04971388      0   1.00000 1.00000 0.019279
## 2  0.04041488      2   0.90057 0.92918 0.019182
## 3  0.02718169      5   0.77611 0.84478 0.018948
## 4  0.02467811      6   0.74893 0.80615 0.018797
## 5  0.02217454      8   0.69957 0.78755 0.018714
## 6  0.01788269      9   0.67740 0.77253 0.018642
## 7  0.00977587     10   0.65951 0.72389 0.018377
## 8  0.00858369     13   0.63019 0.67954 0.018094
## 9  0.00608011     18   0.58226 0.66452 0.017989
## 10 0.00572246     20   0.57010 0.65880 0.017947
## 11 0.00536481     24   0.53934 0.65808 0.017942
## 12 0.00500715     26   0.52861 0.65308 0.017905
## 13 0.00482833     33   0.48784 0.65451 0.017915
## 14 0.00476872     37   0.46853 0.65451 0.017915
## 15 0.00464950     40   0.45422 0.65308 0.017905
## 16 0.00429185     42   0.44492 0.64807 0.017867
## 17 0.00393419     43   0.44063 0.65165 0.017894
## 18 0.00357654     45   0.43276 0.65808 0.017942
## 19 0.00321888     47   0.42561 0.65308 0.017905
## 20 0.00286123     49   0.41917 0.64664 0.017856
## 21 0.00250358     57   0.39557 0.64521 0.017846
## 22 0.00214592     64   0.37768 0.64378 0.017835
## 23 0.00143062     74   0.35622 0.63519 0.017768
## 24 0.00107296     95   0.32546 0.64092 0.017813
## 25 0.00095374    101   0.31903 0.64592 0.017851
## 26 0.00071531    104   0.31617 0.64807 0.017867
## 27 0.00035765    114   0.30901 0.66881 0.018019
## 28 0.00000000    120   0.30687 0.67310 0.018049
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##    273.326102    256.904936    121.662103     83.362005     36.068231 
##        assets 
##      2.894641 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1404/2913 = 0.48198
## 
## n= 2913 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05128205      0   1.00000 1.00000 0.019208
## 2  0.03276353      2   0.89744 0.92450 0.019107
## 3  0.02849003      3   0.86467 0.85256 0.018913
## 4  0.02101140      6   0.77920 0.79772 0.018701
## 5  0.01887464      8   0.73718 0.73362 0.018378
## 6  0.01780627     10   0.69943 0.73362 0.018378
## 7  0.01495726     11   0.68162 0.71083 0.018244
## 8  0.01460114     12   0.66667 0.70085 0.018181
## 9  0.01139601     14   0.63746 0.67735 0.018026
## 10 0.01068376     15   0.62607 0.67308 0.017997
## 11 0.00961538     16   0.61538 0.67735 0.018026
## 12 0.00878443     18   0.59615 0.66952 0.017972
## 13 0.00712251     23   0.54772 0.65456 0.017864
## 14 0.00534188     27   0.51923 0.63105 0.017685
## 15 0.00498575     31   0.49786 0.62607 0.017645
## 16 0.00462963     38   0.45869 0.61182 0.017529
## 17 0.00427350     42   0.44017 0.61396 0.017547
## 18 0.00391738     44   0.43162 0.61396 0.017547
## 19 0.00379867     46   0.42379 0.61182 0.017529
## 20 0.00356125     49   0.41239 0.61396 0.017547
## 21 0.00284900     50   0.40883 0.61610 0.017564
## 22 0.00249288     56   0.39174 0.61325 0.017541
## 23 0.00213675     58   0.38675 0.61396 0.017547
## 24 0.00189934     64   0.37393 0.61396 0.017547
## 25 0.00178063     67   0.36823 0.62179 0.017611
## 26 0.00166192     69   0.36467 0.62251 0.017617
## 27 0.00142450     76   0.35256 0.62037 0.017599
## 28 0.00124644     87   0.33689 0.62037 0.017599
## 29 0.00118708     91   0.33191 0.61538 0.017559
## 30 0.00106838     94   0.32835 0.62251 0.017617
## 31 0.00071225     96   0.32621 0.62963 0.017674
## 32 0.00035613    109   0.31695 0.64672 0.017806
## 33 0.00000000    117   0.31410 0.65598 0.017875
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##    297.604426    275.509893    133.369278    108.778450     58.008635 
##        assets 
##      3.485888 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1397/2908 = 0.4804
## 
## n= 2908 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04974946      0   1.00000 1.00000 0.019286
## 2  0.03149606      2   0.90050 0.90050 0.019124
## 3  0.02791696      3   0.86901 0.82820 0.018894
## 4  0.01968504      6   0.78525 0.79885 0.018772
## 5  0.01789549      8   0.74588 0.76163 0.018593
## 6  0.01360057      9   0.72799 0.74230 0.018490
## 7  0.01145311     13   0.65927 0.71797 0.018349
## 8  0.01073729     14   0.64782 0.68146 0.018114
## 9  0.00966356     19   0.59413 0.66714 0.018014
## 10 0.00715820     21   0.57480 0.66070 0.017967
## 11 0.00644238     26   0.52613 0.64710 0.017866
## 12 0.00536865     28   0.51324 0.64281 0.017834
## 13 0.00501074     30   0.50251 0.64352 0.017839
## 14 0.00465283     38   0.45812 0.64066 0.017817
## 15 0.00429492     44   0.43021 0.63422 0.017767
## 16 0.00357910     46   0.42162 0.63780 0.017795
## 17 0.00286328     50   0.40730 0.64281 0.017834
## 18 0.00250537     51   0.40444 0.64352 0.017839
## 19 0.00238607     53   0.39943 0.64853 0.017877
## 20 0.00214746     56   0.39227 0.63994 0.017812
## 21 0.00178955     61   0.38082 0.63708 0.017789
## 22 0.00167025     65   0.37366 0.63565 0.017778
## 23 0.00143164     72   0.36149 0.63780 0.017795
## 24 0.00107373     89   0.33644 0.64137 0.017823
## 25 0.00071582     91   0.33429 0.64066 0.017817
## 26 0.00040904    103   0.32570 0.65283 0.017910
## 27 0.00035791    111   0.32140 0.65855 0.017952
## 28 0.00023861    119   0.31854 0.65999 0.017962
## 29 0.00017895    122   0.31782 0.65999 0.017962
## 30 0.00000000    126   0.31711 0.65999 0.017962
##    open_nasdq     avg.senti  unemployment        growth interest.rate 
##     302.99877     284.68038     170.50595     104.50972      32.56651 
##        assets 
##      10.99246 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1400/2914 = 0.48044
## 
## n= 2914 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04821429      0   1.00000 1.00000 0.019264
## 2  0.03285714      2   0.90357 0.92286 0.019155
## 3  0.02809524      3   0.87071 0.85429 0.018967
## 4  0.01892857      6   0.78643 0.80929 0.018796
## 5  0.01785714      8   0.74857 0.78571 0.018691
## 6  0.01321429      9   0.73071 0.76929 0.018612
## 7  0.01142857     13   0.66357 0.74429 0.018481
## 8  0.01107143     16   0.62929 0.71429 0.018306
## 9  0.01071429     18   0.60714 0.70714 0.018262
## 10 0.00964286     19   0.59643 0.68929 0.018147
## 11 0.00678571     21   0.57714 0.62929 0.017709
## 12 0.00642857     26   0.52786 0.63357 0.017743
## 13 0.00535714     28   0.51500 0.63214 0.017731
## 14 0.00500000     32   0.49357 0.62071 0.017639
## 15 0.00428571     41   0.44286 0.62071 0.017639
## 16 0.00392857     43   0.43429 0.62000 0.017634
## 17 0.00357143     47   0.41857 0.60643 0.017520
## 18 0.00285714     50   0.40786 0.61429 0.017586
## 19 0.00250000     51   0.40500 0.62214 0.017651
## 20 0.00238095     53   0.40000 0.62214 0.017651
## 21 0.00214286     56   0.39286 0.61929 0.017628
## 22 0.00166667     64   0.37500 0.61286 0.017574
## 23 0.00142857     71   0.36286 0.60929 0.017544
## 24 0.00119048     86   0.34000 0.60929 0.017544
## 25 0.00107143     89   0.33643 0.61071 0.017557
## 26 0.00071429     91   0.33429 0.61571 0.017598
## 27 0.00040816    102   0.32643 0.62786 0.017697
## 28 0.00035714    110   0.32214 0.63286 0.017737
## 29 0.00023810    120   0.31857 0.63286 0.017737
## 30 0.00017857    123   0.31786 0.63571 0.017759
## 31 0.00000000    127   0.31714 0.63500 0.017754
##    open_nasdq     avg.senti  unemployment        growth interest.rate 
##     307.95184     293.39499     157.82017     118.60732      36.53733 
##        assets 
##      12.88333 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1399/2911 = 0.48059
## 
## n= 2911 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04717655      0   1.00000 1.00000 0.019268
## 2  0.04395997      2   0.90565 1.01501 0.019277
## 3  0.04288778      4   0.81773 0.97498 0.019245
## 4  0.02787706      5   0.77484 0.90851 0.019127
## 5  0.02251608      6   0.74696 0.82130 0.018851
## 6  0.02144389      8   0.70193 0.80558 0.018785
## 7  0.01572552      9   0.68049 0.74839 0.018508
## 8  0.01143674     10   0.66476 0.73052 0.018408
## 9  0.00953062     11   0.65332 0.68549 0.018126
## 10 0.00929235     14   0.62473 0.67548 0.018058
## 11 0.00822016     15   0.61544 0.66833 0.018008
## 12 0.00786276     17   0.59900 0.64046 0.017801
## 13 0.00714796     22   0.54896 0.63402 0.017751
## 14 0.00679056     24   0.53467 0.63688 0.017774
## 15 0.00571837     26   0.52109 0.63259 0.017740
## 16 0.00500357     30   0.49035 0.62974 0.017717
## 17 0.00482487     33   0.47534 0.62616 0.017689
## 18 0.00464618     37   0.45604 0.61973 0.017636
## 19 0.00357398     39   0.44675 0.60972 0.017553
## 20 0.00321658     41   0.43960 0.60901 0.017547
## 21 0.00285919     43   0.43317 0.59614 0.017437
## 22 0.00250179     47   0.42173 0.59042 0.017386
## 23 0.00238265     52   0.40743 0.59042 0.017386
## 24 0.00214439     55   0.40029 0.60901 0.017547
## 25 0.00160829     66   0.37598 0.60543 0.017517
## 26 0.00142959     71   0.36741 0.61687 0.017613
## 27 0.00119133     81   0.35311 0.61544 0.017601
## 28 0.00107219     84   0.34954 0.61544 0.017601
## 29 0.00095306     91   0.34167 0.61472 0.017595
## 30 0.00071480    100   0.33310 0.61187 0.017571
## 31 0.00035740    114   0.32309 0.63831 0.017785
## 32 0.00000000    120   0.32094 0.64189 0.017812
##    open_nasdq     avg.senti  unemployment        growth interest.rate 
##     296.20662     295.11683     152.30599      96.35669      37.45761 
##        assets 
##      13.06209 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1395/2911 = 0.47922
## 
## n= 2911 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04946237      0   1.00000 1.00000 0.019322
## 2  0.03297491      2   0.90108 0.91254 0.019186
## 3  0.02700119      3   0.86810 0.87240 0.019077
## 4  0.02078853      6   0.78710 0.81075 0.018852
## 5  0.01863799      8   0.74552 0.78710 0.018746
## 6  0.01792115     11   0.68961 0.77778 0.018701
## 7  0.01433692     12   0.67168 0.77204 0.018673
## 8  0.01290323     14   0.64301 0.74624 0.018537
## 9  0.01003584     15   0.63011 0.71254 0.018340
## 10 0.00967742     16   0.62007 0.70323 0.018282
## 11 0.00860215     18   0.60072 0.68100 0.018134
## 12 0.00681004     23   0.55125 0.66022 0.017987
## 13 0.00573477     27   0.52258 0.65376 0.017939
## 14 0.00544803     29   0.51111 0.64659 0.017885
## 15 0.00537634     35   0.47742 0.64803 0.017896
## 16 0.00501792     37   0.46667 0.64803 0.017896
## 17 0.00430108     40   0.45161 0.63943 0.017830
## 18 0.00394265     41   0.44731 0.63728 0.017813
## 19 0.00382318     45   0.43154 0.63297 0.017779
## 20 0.00358423     48   0.42007 0.63369 0.017785
## 21 0.00322581     51   0.40932 0.62652 0.017728
## 22 0.00286738     53   0.40287 0.62581 0.017722
## 23 0.00250896     55   0.39713 0.62151 0.017687
## 24 0.00238949     57   0.39211 0.62079 0.017681
## 25 0.00215054     60   0.38495 0.61720 0.017652
## 26 0.00179211     65   0.37348 0.61720 0.017652
## 27 0.00167264     69   0.36631 0.61577 0.017640
## 28 0.00143369     76   0.35412 0.62007 0.017675
## 29 0.00107527     89   0.33548 0.61577 0.017640
## 30 0.00071685     93   0.33118 0.63011 0.017757
## 31 0.00035842    106   0.32186 0.66165 0.017998
## 32 0.00000000    114   0.31900 0.66523 0.018024
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##    292.353421    274.985661    136.505811    111.163086     59.061917 
##        assets 
##      3.418517 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1393/2902 = 0.48001
## 
## n= 2902 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05264417      0   1.00000 1.00000 0.019321
## 2  0.03732950      3   0.84207 0.95262 0.019265
## 3  0.01794688      4   0.80474 0.82986 0.018932
## 4  0.01220388      5   0.78679 0.72936 0.018447
## 5  0.01148600     10   0.72362 0.71429 0.018356
## 6  0.00969131     15   0.63819 0.70424 0.018294
## 7  0.00933238     17   0.61881 0.68413 0.018162
## 8  0.00861450     19   0.60014 0.67839 0.018122
## 9  0.00753769     24   0.55492 0.64681 0.017893
## 10 0.00681981     26   0.53984 0.63747 0.017821
## 11 0.00646088     30   0.51256 0.63388 0.017793
## 12 0.00574300     31   0.50610 0.61881 0.017671
## 13 0.00538406     33   0.49462 0.61307 0.017624
## 14 0.00502513     35   0.48385 0.61378 0.017630
## 15 0.00466619     36   0.47882 0.61737 0.017659
## 16 0.00430725     38   0.46949 0.61307 0.017624
## 17 0.00358938     40   0.46088 0.61091 0.017605
## 18 0.00287150     44   0.44652 0.61522 0.017642
## 19 0.00263221     50   0.42714 0.60948 0.017593
## 20 0.00251256     57   0.40775 0.61163 0.017612
## 21 0.00215363     63   0.39268 0.61163 0.017612
## 22 0.00179469     73   0.36899 0.60445 0.017551
## 23 0.00167504     75   0.36540 0.60517 0.017557
## 24 0.00143575     81   0.35535 0.61091 0.017605
## 25 0.00107681     93   0.33812 0.61522 0.017642
## 26 0.00071788     99   0.33166 0.62096 0.017689
## 27 0.00043073    112   0.32233 0.63604 0.017810
## 28 0.00035894    119   0.31874 0.64752 0.017899
## 29 0.00000000    121   0.31802 0.65039 0.017920
##    open_nasdq     avg.senti  unemployment        growth        assets 
##     338.18317     248.19094     173.72147     126.36751      54.02851 
## interest.rate 
##      26.17756 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1399/2908 = 0.48109
## 
## n= 2908 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04932094      0   1.00000 1.00000 0.019259
## 2  0.03359543      2   0.90136 0.94496 0.019193
## 3  0.02740052      3   0.86776 0.87277 0.019024
## 4  0.02251608      6   0.78556 0.82702 0.018867
## 5  0.01965690      8   0.74053 0.79557 0.018735
## 6  0.01858470     10   0.70122 0.79271 0.018723
## 7  0.01501072     11   0.68263 0.74410 0.018479
## 8  0.01036455     14   0.63760 0.70908 0.018274
## 9  0.00964975     16   0.61687 0.68763 0.018136
## 10 0.00786276     18   0.59757 0.67405 0.018044
## 11 0.00619490     23   0.55111 0.65976 0.017942
## 12 0.00607577     27   0.52609 0.65261 0.017889
## 13 0.00571837     31   0.49821 0.64761 0.017852
## 14 0.00500357     35   0.47534 0.64832 0.017857
## 15 0.00464618     38   0.46033 0.64618 0.017841
## 16 0.00428878     40   0.45104 0.64117 0.017803
## 17 0.00393138     41   0.44675 0.63974 0.017792
## 18 0.00381225     43   0.43888 0.64189 0.017808
## 19 0.00357398     46   0.42745 0.64117 0.017803
## 20 0.00285919     50   0.41315 0.63474 0.017753
## 21 0.00250179     52   0.40743 0.62974 0.017713
## 22 0.00238265     55   0.39957 0.62759 0.017696
## 23 0.00214439     58   0.39242 0.62402 0.017667
## 24 0.00178699     66   0.37384 0.62116 0.017644
## 25 0.00166786     69   0.36741 0.61901 0.017627
## 26 0.00142959     72   0.36240 0.62902 0.017708
## 27 0.00119133     87   0.33810 0.63474 0.017753
## 28 0.00107219     90   0.33452 0.63760 0.017775
## 29 0.00083393     98   0.32595 0.64475 0.017830
## 30 0.00071480    106   0.31880 0.66119 0.017952
## 31 0.00035740    118   0.31022 0.66262 0.017963
## 32 0.00000000    128   0.30665 0.67048 0.018019
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##    294.633111    272.587468    140.454566    114.053510     61.176454 
##        assets 
##      6.229428 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1402/2916 = 0.4808
## 
## n= 2916 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05064194      0   1.00000 1.00000 0.019244
## 2  0.03922967      2   0.89872 0.94080 0.019170
## 3  0.02924394      5   0.77817 0.87732 0.019021
## 4  0.02353780      6   0.74893 0.83880 0.018895
## 5  0.02211127      8   0.70185 0.81455 0.018800
## 6  0.01783167      9   0.67974 0.78531 0.018672
## 7  0.01022349     10   0.66191 0.73538 0.018414
## 8  0.00879696     13   0.63124 0.68759 0.018119
## 9  0.00677603     18   0.58274 0.64265 0.017797
## 10 0.00618165     20   0.56919 0.63053 0.017703
## 11 0.00570613     24   0.53709 0.61198 0.017552
## 12 0.00499287     26   0.52568 0.61270 0.017558
## 13 0.00481455     33   0.48573 0.61056 0.017540
## 14 0.00463623     37   0.46648 0.60842 0.017522
## 15 0.00451736     39   0.45720 0.60842 0.017522
## 16 0.00427960     42   0.44365 0.60770 0.017516
## 17 0.00356633     43   0.43937 0.61127 0.017546
## 18 0.00320970     45   0.43224 0.61198 0.017552
## 19 0.00309082     51   0.41298 0.61484 0.017576
## 20 0.00285307     55   0.40014 0.61484 0.017576
## 21 0.00213980     63   0.37660 0.61412 0.017570
## 22 0.00178317     74   0.35235 0.60342 0.017479
## 23 0.00166429     76   0.34879 0.59986 0.017449
## 24 0.00142653     80   0.34165 0.61056 0.017540
## 25 0.00106990     93   0.32311 0.61198 0.017552
## 26 0.00071327    101   0.31455 0.61127 0.017546
## 27 0.00059439    114   0.30528 0.62268 0.017640
## 28 0.00035663    120   0.30171 0.62767 0.017680
## 29 0.00000000    122   0.30100 0.63267 0.017720
##     avg.senti    open_nasdq  unemployment        growth interest.rate 
##    298.255815    283.891807    137.518637     92.748418     42.951666 
##        assets 
##      5.755101 
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1397/2908 = 0.4804
## 
## n= 2908 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05010737      0   1.00000 1.00000 0.019286
## 2  0.03507516      2   0.89979 0.89549 0.019112
## 3  0.02576951      5   0.79456 0.82462 0.018880
## 4  0.02147459      7   0.74302 0.78454 0.018706
## 5  0.01932713      8   0.72155 0.74803 0.018521
## 6  0.01789549     10   0.68289 0.73372 0.018441
## 7  0.01073729     11   0.66500 0.71797 0.018349
## 8  0.01037938     14   0.63135 0.71152 0.018309
## 9  0.00930565     16   0.61059 0.70580 0.018273
## 10 0.00858984     18   0.59198 0.69435 0.018200
## 11 0.00787402     22   0.55404 0.67072 0.018039
## 12 0.00608447     24   0.53830 0.64209 0.017828
## 13 0.00558339     26   0.52613 0.63994 0.017812
## 14 0.00501074     32   0.49177 0.64137 0.017823
## 15 0.00447387     35   0.47674 0.63923 0.017806
## 16 0.00429492     39   0.45884 0.63422 0.017767
## 17 0.00393701     44   0.43737 0.62491 0.017693
## 18 0.00357910     46   0.42949 0.62205 0.017670
## 19 0.00286328     52   0.40802 0.61990 0.017652
## 20 0.00250537     53   0.40515 0.62062 0.017658
## 21 0.00238607     55   0.40014 0.62419 0.017687
## 22 0.00229062     65   0.37581 0.62348 0.017681
## 23 0.00214746     71   0.36077 0.61990 0.017652
## 24 0.00143164     81   0.33930 0.61274 0.017593
## 25 0.00119303     89   0.32785 0.61918 0.017646
## 26 0.00107373     92   0.32427 0.61346 0.017599
## 27 0.00083512     94   0.32212 0.61489 0.017611
## 28 0.00071582    102   0.31496 0.62706 0.017710
## 29 0.00035791    106   0.31210 0.63350 0.017761
## 30 0.00023861    110   0.31067 0.63422 0.017767
## 31 0.00000000    113   0.30995 0.63923 0.017806
##    open_nasdq     avg.senti  unemployment        growth interest.rate 
##     324.85473     316.06457     169.49044     120.55475      69.61296 
##        assets 
##      54.32910
x2 <- as.data.frame(rep(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                          20, 21, 22, 23, 24, 25, 26, 27, 28, 29), each = 6))
tree.firm29 <- cbind(tree.firm29, x2)
colnames(tree.firm29) <- c("importance", "number")

##Print company name
for (j in unique(train$name))
  firm <- as.data.frame(as.character(unique(train$name)))
colnames(firm) <- c("firm")
x1 <- as.data.frame(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                      20, 21, 22, 23, 24, 25, 26, 27, 28, 29))
colnames(x1) <- c("number")
firm.name <- cbind(firm, x1)

#Total companies' name and their decision tree variable importance
company.importance <- merge(firm.name, tree.firm29, by = "number")


##meanf1
meanf1.company <- function(){
  
  results <- data.frame()
  
  scores2 <- data.frame() 
  for (i in unique(train$kfold)){
    for (j in unique(train$name)){
      
      scores2 <- data.frame() 
      train1 <- train[train$name != j, ]
      
      # Refit with optimal
      # cp = 0
      fit.0 <- rpart(ChangeOpening ~ avg.senti + name + growth + 
                       interest.rate + unemployment + open_nasdq + assets, 
                     method = "class", data = train1[train1$kfold != i, ], cp = 0)
      # printcp(fit.0)
      # Put all cp into a data frame
      fit.0.df <- as.data.frame(printcp(fit.0))
      # Find the optimal cp
      a <- min(fit.0.df$xerror)
      b <- subset(fit.0.df, xerror == a)[, 5]
      c <- a + b
      d <- max(fit.0.df$xerror[fit.0.df$xerror <= c])
      cp.opt <- max(subset(fit.0.df, xerror == d)[, 1])
      
      # Run the optimal decision tree
      fit.opt <- rpart(ChangeOpening ~ avg.senti + growth + interest.rate + 
                         unemployment + open_nasdq + assets, 
                       method = "class", data = train1[train1$kfold != i, ], cp = cp.opt)
      
      # Predict values for test set
      pred.opt.test <- predict(fit.opt, train1[train1$kfold == i, ], type='class')
      scores2 <- rbind(scores2, data.frame(model = "Decision Tree", 
                                           actual = train1[train1$kfold == i, ]$ChangeOpening, 
                                           predicted = pred.opt.test))
      
      # Mean F1
      mean.data <- meanf1(scores2$actual, scores2$predicted)
      # Append
      results <- rbind(results, mean.data)
      colnames(results) <- "meanf1"
    }
    return(results)
  }
}

meanf1.firm29 <- meanf1.company()
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2913 = 0.48095
## 
## n= 2913 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05032120      0   1.00000 1.00000 0.019248
## 2  0.04175589      2   0.89936 0.96431 0.019211
## 3  0.03783012      4   0.81585 0.90792 0.019107
## 4  0.02498216      5   0.77802 0.84226 0.018912
## 5  0.02391149      7   0.72805 0.81513 0.018808
## 6  0.01784440      9   0.68023 0.77802 0.018642
## 7  0.01284797     11   0.64454 0.74090 0.018450
## 8  0.00975494     12   0.63169 0.70450 0.018234
## 9  0.00880324     15   0.60243 0.68594 0.018113
## 10 0.00678087     20   0.55389 0.64668 0.017833
## 11 0.00642398     22   0.54033 0.64668 0.017833
## 12 0.00571021     25   0.52034 0.65810 0.017918
## 13 0.00499643     28   0.50321 0.65525 0.017897
## 14 0.00428266     37   0.45325 0.66024 0.017934
## 15 0.00392577     41   0.43612 0.65882 0.017923
## 16 0.00356888     43   0.42827 0.65739 0.017913
## 17 0.00309303     44   0.42470 0.65525 0.017897
## 18 0.00285510     50   0.40614 0.65453 0.017892
## 19 0.00249822     55   0.39186 0.64882 0.017849
## 20 0.00214133     59   0.38187 0.63740 0.017762
## 21 0.00190340     68   0.36260 0.63597 0.017751
## 22 0.00166548     71   0.35689 0.64097 0.017790
## 23 0.00142755     75   0.34975 0.63597 0.017751
## 24 0.00118963     86   0.33333 0.63669 0.017756
## 25 0.00107066     89   0.32976 0.63812 0.017768
## 26 0.00071378    103   0.31406 0.64311 0.017806
## 27 0.00059481    110   0.30906 0.65667 0.017908
## 28 0.00035689    116   0.30550 0.66524 0.017970
## 29 0.00000000    120   0.30407 0.66453 0.017965
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2910 = 0.48144
## 
## n= 2910 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04925054      0   1.00000 1.00000 0.019239
## 2  0.04139900      2   0.90150 0.98572 0.019227
## 3  0.02640971      5   0.77373 0.82727 0.018850
## 4  0.02462527      6   0.74732 0.81941 0.018819
## 5  0.02284083      8   0.69807 0.81513 0.018801
## 6  0.01641685      9   0.67523 0.76374 0.018566
## 7  0.01142041     10   0.65882 0.73448 0.018408
## 8  0.00999286     11   0.64739 0.69736 0.018184
## 9  0.00951701     12   0.63740 0.67666 0.018046
## 10 0.00785153     15   0.60885 0.66024 0.017929
## 11 0.00678087     17   0.59315 0.64597 0.017824
## 12 0.00642398     19   0.57959 0.63455 0.017736
## 13 0.00571021     24   0.53176 0.61313 0.017563
## 14 0.00547228     27   0.51463 0.61313 0.017563
## 15 0.00499643     31   0.48465 0.60742 0.017515
## 16 0.00481799     35   0.46467 0.60742 0.017515
## 17 0.00428266     39   0.44540 0.60885 0.017527
## 18 0.00392577     42   0.43255 0.61028 0.017539
## 19 0.00356888     44   0.42470 0.61171 0.017551
## 20 0.00321199     46   0.41756 0.61242 0.017557
## 21 0.00285510     48   0.41113 0.60671 0.017509
## 22 0.00237925     50   0.40542 0.60314 0.017478
## 23 0.00214133     53   0.39829 0.60385 0.017485
## 24 0.00190340     65   0.37116 0.60385 0.017485
## 25 0.00142755     68   0.36545 0.60029 0.017454
## 26 0.00118963     76   0.35403 0.60885 0.017527
## 27 0.00107066     88   0.33976 0.61171 0.017551
## 28 0.00071378     92   0.33547 0.61956 0.017616
## 29 0.00059481    103   0.32762 0.62955 0.017696
## 30 0.00047585    109   0.32405 0.63026 0.017702
## 31 0.00023793    115   0.32120 0.63312 0.017725
## 32 0.00000000    125   0.31620 0.63669 0.017752
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1395/2912 = 0.47905
## 
## n= 2912 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04874552      0   1.00000 1.00000 0.019325
## 2  0.04121864      2   0.90251 0.93047 0.019227
## 3  0.03870968      4   0.82007 0.92330 0.019212
## 4  0.02580645      5   0.78136 0.84014 0.018970
## 5  0.02437276      7   0.72975 0.81290 0.018863
## 6  0.01792115      9   0.68100 0.74982 0.018559
## 7  0.01720430     10   0.66308 0.71900 0.018382
## 8  0.01362007     11   0.64588 0.71470 0.018355
## 9  0.00955795     12   0.63226 0.70609 0.018302
## 10 0.00836320     15   0.60358 0.70466 0.018292
## 11 0.00645161     20   0.55556 0.64946 0.017909
## 12 0.00609319     23   0.53548 0.64301 0.017859
## 13 0.00573477     25   0.52330 0.64014 0.017837
## 14 0.00501792     29   0.50036 0.64516 0.017876
## 15 0.00465950     37   0.45663 0.64588 0.017881
## 16 0.00430108     41   0.43799 0.64946 0.017909
## 17 0.00358423     44   0.42509 0.64086 0.017843
## 18 0.00310633     49   0.40717 0.63513 0.017798
## 19 0.00262843     52   0.39785 0.63011 0.017758
## 20 0.00215054     56   0.38638 0.63656 0.017809
## 21 0.00179211     69   0.35771 0.63441 0.017792
## 22 0.00143369     71   0.35412 0.62939 0.017752
## 23 0.00125448     84   0.33333 0.62724 0.017735
## 24 0.00107527     91   0.32330 0.62437 0.017712
## 25 0.00095579     95   0.31900 0.62652 0.017729
## 26 0.00071685     98   0.31613 0.63154 0.017769
## 27 0.00043011    107   0.30968 0.65305 0.017935
## 28 0.00035842    114   0.30466 0.66452 0.018020
## 29 0.00000000    120   0.30251 0.66738 0.018040
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1403/2912 = 0.4818
## 
## n= 2912 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04989309      0   1.00000 1.00000 0.019219
## 2  0.04632929      1   0.95011 1.00143 0.019219
## 3  0.03528154      2   0.90378 0.96080 0.019178
## 4  0.03421240      4   0.83321 0.88168 0.019012
## 5  0.02637206      5   0.79900 0.84248 0.018888
## 6  0.02209551      7   0.74626 0.82823 0.018835
## 7  0.01888810      8   0.72416 0.78617 0.018658
## 8  0.01781896     10   0.68639 0.76764 0.018568
## 9  0.01211689     11   0.66857 0.75339 0.018495
## 10 0.01069138     12   0.65645 0.71062 0.018251
## 11 0.00962224     13   0.64576 0.69494 0.018152
## 12 0.00926586     18   0.59301 0.68068 0.018057
## 13 0.00784034     20   0.57448 0.65574 0.017881
## 14 0.00641483     25   0.52602 0.64861 0.017828
## 15 0.00570207     26   0.51960 0.63792 0.017746
## 16 0.00534569     30   0.49679 0.62723 0.017662
## 17 0.00498931     34   0.47541 0.62937 0.017679
## 18 0.00463293     35   0.47042 0.62580 0.017651
## 19 0.00427655     37   0.46115 0.62438 0.017640
## 20 0.00392017     42   0.43977 0.61725 0.017582
## 21 0.00356379     44   0.43193 0.62438 0.017640
## 22 0.00285103     50   0.41055 0.61440 0.017558
## 23 0.00237586     52   0.40485 0.62010 0.017605
## 24 0.00213828     59   0.38774 0.62295 0.017628
## 25 0.00178190     70   0.36208 0.62509 0.017645
## 26 0.00166310     72   0.35852 0.62295 0.017628
## 27 0.00142552     75   0.35353 0.62081 0.017611
## 28 0.00071276     89   0.33357 0.62794 0.017668
## 29 0.00042766    103   0.32359 0.65217 0.017854
## 30 0.00035638    109   0.32074 0.65716 0.017891
## 31 0.00000000    115   0.31860 0.66785 0.017968
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1391/2900 = 0.47966
## 
## n= 2900 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04924515      0   1.00000 1.00000 0.019341
## 2  0.04133717      2   0.90151 0.97628 0.019318
## 3  0.03882099      4   0.81884 0.96262 0.019300
## 4  0.02588066      5   0.78001 0.89216 0.019155
## 5  0.02408339      7   0.72825 0.80446 0.018846
## 6  0.01869159      9   0.68009 0.76420 0.018655
## 7  0.01797268     10   0.66139 0.74551 0.018555
## 8  0.01294033     11   0.64342 0.72538 0.018440
## 9  0.00958543     12   0.63048 0.67649 0.018125
## 10 0.00718907     15   0.60173 0.65349 0.017959
## 11 0.00611071     20   0.55284 0.65636 0.017981
## 12 0.00603882     24   0.52840 0.65349 0.017959
## 13 0.00575126     29   0.49820 0.65564 0.017975
## 14 0.00503235     32   0.48095 0.65133 0.017943
## 15 0.00431344     35   0.46585 0.65133 0.017943
## 16 0.00395399     37   0.45723 0.65277 0.017954
## 17 0.00359454     42   0.43422 0.64486 0.017894
## 18 0.00323508     49   0.40906 0.64127 0.017866
## 19 0.00311526     51   0.40259 0.64342 0.017883
## 20 0.00287563     54   0.39324 0.64342 0.017883
## 21 0.00263599     56   0.38749 0.63408 0.017810
## 22 0.00251618     60   0.37599 0.63839 0.017844
## 23 0.00215672     64   0.36592 0.63120 0.017787
## 24 0.00179727     74   0.34364 0.63480 0.017816
## 25 0.00143781     76   0.34004 0.63264 0.017799
## 26 0.00107836     87   0.32279 0.63480 0.017816
## 27 0.00089863     93   0.31632 0.63480 0.017816
## 28 0.00071891     97   0.31272 0.63480 0.017816
## 29 0.00043134    109   0.30410 0.65349 0.017959
## 30 0.00035945    116   0.29978 0.66211 0.018023
## 31 0.00000000    120   0.29835 0.66068 0.018012
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1400/2910 = 0.4811
## 
## n= 2910 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05357143      0   1.00000 1.00000 0.019252
## 2  0.05250000      1   0.94643 1.00000 0.019252
## 3  0.03392857      3   0.84143 0.90786 0.019111
## 4  0.02785714      5   0.77357 0.81571 0.018815
## 5  0.02142857      6   0.74571 0.79643 0.018732
## 6  0.01928571      7   0.72429 0.73786 0.018438
## 7  0.01857143      9   0.68571 0.72500 0.018364
## 8  0.01785714     10   0.66714 0.72214 0.018347
## 9  0.01071429     11   0.64929 0.69286 0.018164
## 10 0.00785714     12   0.63857 0.67857 0.018068
## 11 0.00714286     19   0.57714 0.65000 0.017863
## 12 0.00607143     23   0.54357 0.63929 0.017782
## 13 0.00557143     25   0.53143 0.62643 0.017680
## 14 0.00500000     30   0.50357 0.62714 0.017686
## 15 0.00464286     32   0.49357 0.62571 0.017675
## 16 0.00428571     36   0.47500 0.62714 0.017686
## 17 0.00392857     39   0.46214 0.62643 0.017680
## 18 0.00380952     41   0.45429 0.62929 0.017703
## 19 0.00357143     44   0.44286 0.62857 0.017698
## 20 0.00285714     49   0.42500 0.62500 0.017669
## 21 0.00250000     52   0.41643 0.61500 0.017587
## 22 0.00238095     54   0.41143 0.61357 0.017575
## 23 0.00214286     61   0.39429 0.61643 0.017599
## 24 0.00142857     71   0.37286 0.61357 0.017575
## 25 0.00119048     90   0.34500 0.61071 0.017552
## 26 0.00095238     93   0.34143 0.61071 0.017552
## 27 0.00071429     97   0.33643 0.61571 0.017593
## 28 0.00047619    108   0.32857 0.63214 0.017726
## 29 0.00035714    111   0.32714 0.63143 0.017720
## 30 0.00000000    115   0.32571 0.65000 0.017863
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1397/2906 = 0.48073
## 
## n= 2906 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04903364      0   1.00000 1.00000 0.019280
## 2  0.04080172      2   0.90193 0.92341 0.019172
## 3  0.02648533      5   0.77452 0.84324 0.018945
## 4  0.02219041      6   0.74803 0.81317 0.018829
## 5  0.02183250      7   0.72584 0.78812 0.018719
## 6  0.01789549      9   0.68218 0.79098 0.018732
## 7  0.00954426     10   0.66428 0.71940 0.018354
## 8  0.00715820     13   0.63565 0.67359 0.018056
## 9  0.00680029     15   0.62133 0.65855 0.017949
## 10 0.00644238     20   0.57266 0.66428 0.017990
## 11 0.00601288     22   0.55977 0.65784 0.017944
## 12 0.00572656     27   0.52971 0.65569 0.017928
## 13 0.00536865     32   0.49320 0.65426 0.017917
## 14 0.00483178     34   0.48246 0.65211 0.017901
## 15 0.00465283     38   0.46314 0.65497 0.017923
## 16 0.00357910     42   0.44452 0.65068 0.017891
## 17 0.00322119     44   0.43737 0.64209 0.017826
## 18 0.00286328     51   0.41374 0.64424 0.017842
## 19 0.00250537     53   0.40802 0.64639 0.017858
## 20 0.00214746     57   0.39800 0.65068 0.017891
## 21 0.00178955     68   0.37366 0.64424 0.017842
## 22 0.00161059     74   0.36292 0.64996 0.017885
## 23 0.00143164     78   0.35648 0.65354 0.017912
## 24 0.00107373     95   0.33214 0.65283 0.017907
## 25 0.00095443     97   0.32999 0.66142 0.017970
## 26 0.00071582    103   0.32427 0.66142 0.017970
## 27 0.00047721    115   0.31568 0.66356 0.017985
## 28 0.00035791    121   0.31281 0.66213 0.017975
## 29 0.00023861    127   0.31067 0.66070 0.017965
## 30 0.00000000    130   0.30995 0.66356 0.017985
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1395/2908 = 0.47971
## 
## n= 2908 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04695341      0   1.00000 1.00000 0.019312
## 2  0.04336918      2   0.90609 0.99928 0.019312
## 3  0.04014337      4   0.81935 0.97993 0.019294
## 4  0.02473118      5   0.77921 0.87885 0.019089
## 5  0.02150538      7   0.72975 0.79713 0.018786
## 6  0.01792115      9   0.68674 0.78351 0.018723
## 7  0.01290323     10   0.66882 0.74409 0.018520
## 8  0.00955795     11   0.65591 0.69892 0.018249
## 9  0.00896057     19   0.57706 0.68172 0.018135
## 10 0.00716846     23   0.54050 0.66093 0.017988
## 11 0.00681004     25   0.52616 0.65950 0.017978
## 12 0.00645161     27   0.51254 0.65233 0.017924
## 13 0.00573477     31   0.48602 0.64444 0.017865
## 14 0.00501792     35   0.46308 0.64301 0.017854
## 15 0.00394265     42   0.42796 0.64086 0.017837
## 16 0.00358423     44   0.42007 0.62939 0.017747
## 17 0.00322581     45   0.41649 0.61434 0.017624
## 18 0.00286738     48   0.40573 0.62007 0.017671
## 19 0.00250896     53   0.39140 0.61147 0.017600
## 20 0.00215054     55   0.38638 0.60932 0.017582
## 21 0.00191159     75   0.34122 0.60717 0.017563
## 22 0.00143369     78   0.33548 0.61434 0.017624
## 23 0.00107527     90   0.31541 0.62581 0.017718
## 24 0.00071685     96   0.30896 0.62939 0.017747
## 25 0.00047790    114   0.29606 0.64229 0.017848
## 26 0.00035842    117   0.29462 0.64659 0.017881
## 27 0.00000000    121   0.29319 0.64803 0.017892
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2922 = 0.47947
## 
## n= 2922 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04817987      0   1.00000 1.00000 0.019275
## 2  0.04104211      2   0.90364 0.96217 0.019234
## 3  0.02783726      5   0.77730 0.84511 0.018942
## 4  0.02462527      6   0.74946 0.77730 0.018656
## 5  0.02212705      8   0.70021 0.75232 0.018528
## 6  0.01784440      9   0.67809 0.72305 0.018362
## 7  0.00927909     10   0.66024 0.70378 0.018244
## 8  0.00678087     15   0.61385 0.66381 0.017972
## 9  0.00642398     20   0.56460 0.64454 0.017829
## 10 0.00594813     21   0.55817 0.64454 0.017829
## 11 0.00535332     25   0.52677 0.64383 0.017824
## 12 0.00499643     29   0.50535 0.63526 0.017757
## 13 0.00481799     30   0.50036 0.62955 0.017712
## 14 0.00463954     34   0.48108 0.61813 0.017619
## 15 0.00392577     38   0.46253 0.60742 0.017530
## 16 0.00356888     41   0.44754 0.62099 0.017643
## 17 0.00321199     43   0.44040 0.62812 0.017701
## 18 0.00309303     47   0.42755 0.64026 0.017796
## 19 0.00285510     50   0.41827 0.64026 0.017796
## 20 0.00249822     52   0.41256 0.64311 0.017818
## 21 0.00237925     54   0.40757 0.64097 0.017802
## 22 0.00214133     57   0.40043 0.64311 0.017818
## 23 0.00190340     74   0.36046 0.64311 0.017818
## 24 0.00142755     77   0.35475 0.64311 0.017818
## 25 0.00118963     83   0.34618 0.64311 0.017818
## 26 0.00107066     86   0.34261 0.65453 0.017905
## 27 0.00095170     94   0.33405 0.65953 0.017941
## 28 0.00071378    102   0.32620 0.66167 0.017957
## 29 0.00059481    114   0.31763 0.67737 0.018068
## 30 0.00017844    120   0.31406 0.68522 0.018122
## 31 0.00000000    124   0.31335 0.68665 0.018132
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1397/2912 = 0.47974
## 
## n= 2912 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04974946      0   1.00000 1.00000 0.019298
## 2  0.04187545      2   0.90050 0.91625 0.019172
## 3  0.04151754      4   0.81675 0.90766 0.019152
## 4  0.02576951      5   0.77523 0.84681 0.018971
## 5  0.02505369      7   0.72369 0.80172 0.018793
## 6  0.01861131      9   0.67359 0.77881 0.018687
## 7  0.01360057     11   0.63636 0.72155 0.018377
## 8  0.00954426     12   0.62276 0.68146 0.018120
## 9  0.00715820     15   0.59413 0.63708 0.017795
## 10 0.00680029     20   0.54545 0.63064 0.017744
## 11 0.00608447     22   0.53185 0.62563 0.017704
## 12 0.00536865     24   0.51969 0.61990 0.017657
## 13 0.00524934     26   0.50895 0.61560 0.017622
## 14 0.00501074     30   0.48676 0.61131 0.017586
## 15 0.00465283     35   0.46170 0.61131 0.017586
## 16 0.00429492     39   0.44309 0.60415 0.017525
## 17 0.00393701     41   0.43450 0.60773 0.017555
## 18 0.00357910     47   0.41088 0.59413 0.017438
## 19 0.00322119     51   0.39656 0.59986 0.017488
## 20 0.00262467     53   0.39012 0.59556 0.017450
## 21 0.00214746     57   0.37867 0.60630 0.017543
## 22 0.00190885     66   0.35863 0.60558 0.017537
## 23 0.00143164     69   0.35290 0.60558 0.017537
## 24 0.00125268     81   0.33429 0.60200 0.017506
## 25 0.00119303     87   0.32498 0.60487 0.017531
## 26 0.00107373     91   0.31926 0.60129 0.017500
## 27 0.00071582    101   0.30852 0.60129 0.017500
## 28 0.00059652    111   0.30136 0.61632 0.017628
## 29 0.00040904    117   0.29778 0.61775 0.017639
## 30 0.00035791    124   0.29492 0.62205 0.017675
## 31 0.00017895    130   0.29277 0.62205 0.017675
## 32 0.00000000    134   0.29205 0.62276 0.017681
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1396/2905 = 0.48055
## 
## n= 2905 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04835244      0   1.00000 1.00000 0.019290
## 2  0.04226361      2   0.90330 0.97636 0.019268
## 3  0.02793696      5   0.77364 0.86748 0.019036
## 4  0.02292264      6   0.74570 0.80086 0.018786
## 5  0.02256447      7   0.72278 0.77579 0.018669
## 6  0.01790831      9   0.67765 0.75931 0.018586
## 7  0.00978988     10   0.65974 0.68911 0.018170
## 8  0.00955110     13   0.63037 0.67264 0.018058
## 9  0.00680516     18   0.58023 0.66476 0.018002
## 10 0.00601719     20   0.56662 0.64685 0.017870
## 11 0.00573066     25   0.53653 0.64828 0.017881
## 12 0.00537249     29   0.51361 0.65043 0.017897
## 13 0.00525310     31   0.50287 0.64542 0.017859
## 14 0.00483524     35   0.47350 0.64900 0.017886
## 15 0.00429799     39   0.45415 0.65258 0.017913
## 16 0.00358166     40   0.44986 0.64613 0.017864
## 17 0.00322350     42   0.44269 0.64828 0.017881
## 18 0.00310411     47   0.42550 0.65473 0.017929
## 19 0.00286533     50   0.41619 0.65473 0.017929
## 20 0.00250716     57   0.39613 0.64756 0.017875
## 21 0.00214900     61   0.38610 0.64398 0.017848
## 22 0.00191022     71   0.36390 0.64542 0.017859
## 23 0.00143266     74   0.35817 0.64327 0.017842
## 24 0.00107450     86   0.33954 0.63897 0.017809
## 25 0.00071633     93   0.33166 0.64398 0.017848
## 26 0.00042980    107   0.32163 0.65688 0.017945
## 27 0.00035817    114   0.31734 0.65544 0.017934
## 28 0.00000000    116   0.31662 0.65115 0.017902
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1406/2911 = 0.483
## 
## n= 2911 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05547653      0   1.00000 1.00000 0.019176
## 2  0.04694168      1   0.94452 1.00996 0.019181
## 3  0.04196302      2   0.89758 0.97440 0.019154
## 4  0.03058321      5   0.77027 0.86558 0.018928
## 5  0.02204836      6   0.73969 0.80014 0.018686
## 6  0.02133713      8   0.69559 0.78663 0.018626
## 7  0.01778094      9   0.67425 0.77027 0.018548
## 8  0.00995733     10   0.65647 0.72475 0.018304
## 9  0.00675676     13   0.62660 0.64651 0.017783
## 10 0.00640114     17   0.59957 0.61807 0.017560
## 11 0.00533428     22   0.55192 0.61807 0.017560
## 12 0.00497866     24   0.54125 0.62162 0.017589
## 13 0.00480085     35   0.47368 0.61735 0.017554
## 14 0.00450450     39   0.45448 0.61735 0.017554
## 15 0.00426743     42   0.44097 0.61878 0.017566
## 16 0.00355619     43   0.43670 0.61807 0.017560
## 17 0.00320057     44   0.43314 0.61735 0.017554
## 18 0.00284495     46   0.42674 0.62447 0.017612
## 19 0.00248933     58   0.39118 0.62162 0.017589
## 20 0.00213371     64   0.37624 0.60953 0.017490
## 21 0.00189663     69   0.36558 0.60882 0.017484
## 22 0.00177809     72   0.35989 0.61522 0.017537
## 23 0.00165955     75   0.35349 0.62020 0.017578
## 24 0.00142248     79   0.34637 0.61949 0.017572
## 25 0.00106686     91   0.32930 0.61949 0.017572
## 26 0.00071124     93   0.32717 0.63514 0.017696
## 27 0.00047416    102   0.32077 0.66430 0.017913
## 28 0.00035562    111   0.31650 0.66287 0.017903
## 29 0.00023708    117   0.31437 0.66856 0.017943
## 30 0.00000000    127   0.30939 0.66572 0.017923
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2908 = 0.48177
## 
## n= 2908 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04996431      0   1.00000 1.00000 0.019233
## 2  0.04925054      1   0.95004 0.96146 0.019193
## 3  0.03069236      2   0.90079 0.90435 0.019086
## 4  0.02902689      3   0.87009 0.85368 0.018940
## 5  0.02177016      6   0.78301 0.79586 0.018715
## 6  0.01927195      8   0.73947 0.74590 0.018468
## 7  0.01784440     10   0.70093 0.73376 0.018401
## 8  0.01391863     12   0.66524 0.71734 0.018305
## 9  0.01070664     14   0.63740 0.70949 0.018257
## 10 0.00927909     16   0.61599 0.67452 0.018028
## 11 0.00832739     18   0.59743 0.65382 0.017880
## 12 0.00642398     23   0.55032 0.63455 0.017733
## 13 0.00535332     27   0.52177 0.63241 0.017716
## 14 0.00499643     29   0.51106 0.62812 0.017682
## 15 0.00428266     40   0.45111 0.62527 0.017660
## 16 0.00380680     44   0.43398 0.62741 0.017677
## 17 0.00356888     47   0.42256 0.62741 0.017677
## 18 0.00321199     51   0.40828 0.62598 0.017665
## 19 0.00285510     53   0.40186 0.62241 0.017636
## 20 0.00237925     55   0.39615 0.61456 0.017572
## 21 0.00214133     58   0.38901 0.61313 0.017560
## 22 0.00178444     65   0.37330 0.60742 0.017512
## 23 0.00166548     68   0.36759 0.60956 0.017530
## 24 0.00142755     72   0.36046 0.61599 0.017584
## 25 0.00118963     83   0.34475 0.61884 0.017607
## 26 0.00107066     86   0.34118 0.61670 0.017590
## 27 0.00083274     88   0.33904 0.62099 0.017625
## 28 0.00071378     96   0.33191 0.64454 0.017810
## 29 0.00035689    108   0.32334 0.65239 0.017869
## 30 0.00000000    120   0.31906 0.66238 0.017942
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1394/2903 = 0.48019
## 
## n= 2903 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04842181      0   1.00000 1.00000 0.019310
## 2  0.04304161      2   0.90316 0.96126 0.019268
## 3  0.04088953      4   0.81707 0.95194 0.019254
## 4  0.02797704      5   0.77618 0.86585 0.019049
## 5  0.02259684      6   0.74821 0.82353 0.018898
## 6  0.02080344      8   0.70301 0.75681 0.018590
## 7  0.01793400      9   0.68221 0.74964 0.018552
## 8  0.00932568     10   0.66428 0.70660 0.018300
## 9  0.00908656     12   0.64562 0.70445 0.018287
## 10 0.00836920     15   0.61836 0.69727 0.018241
## 11 0.00789096     19   0.58178 0.69512 0.018227
## 12 0.00717360     21   0.56600 0.66714 0.018035
## 13 0.00681492     25   0.53228 0.66212 0.017999
## 14 0.00645624     27   0.51865 0.66356 0.018009
## 15 0.00609756     28   0.51220 0.65854 0.017973
## 16 0.00502152     30   0.50000 0.64347 0.017860
## 17 0.00466284     34   0.47991 0.62697 0.017730
## 18 0.00430416     36   0.47059 0.62410 0.017707
## 19 0.00394548     40   0.45337 0.62410 0.017707
## 20 0.00358680     42   0.44548 0.62195 0.017689
## 21 0.00322812     46   0.43113 0.62482 0.017713
## 22 0.00310856     50   0.41822 0.62267 0.017695
## 23 0.00286944     53   0.40890 0.62267 0.017695
## 24 0.00251076     54   0.40603 0.61908 0.017666
## 25 0.00239120     61   0.38666 0.61908 0.017666
## 26 0.00215208     65   0.37661 0.61191 0.017606
## 27 0.00179340     81   0.33931 0.61406 0.017624
## 28 0.00143472     83   0.33572 0.61478 0.017630
## 29 0.00119560     90   0.32568 0.60904 0.017582
## 30 0.00107604     93   0.32209 0.61191 0.017606
## 31 0.00095648     99   0.31564 0.61908 0.017666
## 32 0.00071736    102   0.31277 0.62339 0.017701
## 33 0.00053802    116   0.30273 0.64060 0.017838
## 34 0.00047824    120   0.30057 0.64132 0.017843
## 35 0.00043042    123   0.29914 0.64706 0.017887
## 36 0.00035868    130   0.29412 0.65495 0.017946
## 37 0.00023912    132   0.29340 0.65495 0.017946
## 38 0.00000000    135   0.29268 0.65495 0.017946
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2909 = 0.48161
## 
## n= 2909 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05258149      0   1.00000 1.00000 0.019236
## 2  0.04068522      3   0.84226 0.92006 0.019124
## 3  0.01784440      4   0.80157 0.84083 0.018898
## 4  0.01237212      5   0.78373 0.72091 0.018328
## 5  0.01094456      9   0.73162 0.69094 0.018140
## 6  0.00856531     14   0.64525 0.65739 0.017907
## 7  0.00832739     16   0.62812 0.65525 0.017892
## 8  0.00713776     21   0.58101 0.64739 0.017833
## 9  0.00678087     23   0.56674 0.62955 0.017695
## 10 0.00606709     25   0.55318 0.62884 0.017689
## 11 0.00556745     29   0.52891 0.63098 0.017706
## 12 0.00535332     35   0.49465 0.63098 0.017706
## 13 0.00499643     37   0.48394 0.63098 0.017706
## 14 0.00475851     38   0.47894 0.62884 0.017689
## 15 0.00428266     41   0.46467 0.63383 0.017729
## 16 0.00380680     44   0.45182 0.64454 0.017811
## 17 0.00356888     47   0.44040 0.63954 0.017773
## 18 0.00285510     52   0.42256 0.63526 0.017740
## 19 0.00261718     53   0.41970 0.62884 0.017689
## 20 0.00214133     56   0.41185 0.62313 0.017644
## 21 0.00166548     67   0.38544 0.61242 0.017556
## 22 0.00142755     74   0.37330 0.62170 0.017632
## 23 0.00107066     91   0.34832 0.62241 0.017638
## 24 0.00071378    107   0.33048 0.62955 0.017695
## 25 0.00035689    116   0.32405 0.63954 0.017773
## 26 0.00017844    120   0.32263 0.65525 0.017892
## 27 0.00000000    124   0.32191 0.65382 0.017881
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1399/2910 = 0.48076
## 
## n= 2910 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05289492      0   1.00000 1.00000 0.019265
## 2  0.04479390      1   0.94711 0.99285 0.019260
## 3  0.03859900      4   0.81272 0.93924 0.019189
## 4  0.03002144      5   0.77412 0.83631 0.018906
## 5  0.02394568      6   0.74410 0.81058 0.018805
## 6  0.02001430      8   0.69621 0.76483 0.018592
## 7  0.01786991      9   0.67620 0.74982 0.018514
## 8  0.00953062     10   0.65833 0.70336 0.018242
## 9  0.00822016     13   0.62974 0.67191 0.018032
## 10 0.00679056     18   0.57970 0.63760 0.017778
## 11 0.00643317     20   0.56612 0.64475 0.017833
## 12 0.00571837     24   0.53252 0.64403 0.017827
## 13 0.00500357     27   0.51537 0.62831 0.017705
## 14 0.00428878     36   0.46605 0.61472 0.017594
## 15 0.00393138     38   0.45747 0.61187 0.017570
## 16 0.00357398     40   0.44961 0.61330 0.017582
## 17 0.00321658     44   0.43531 0.61401 0.017588
## 18 0.00309745     46   0.42888 0.61472 0.017594
## 19 0.00285919     49   0.41959 0.61472 0.017594
## 20 0.00250179     52   0.41101 0.60686 0.017528
## 21 0.00238265     62   0.38528 0.60400 0.017503
## 22 0.00214439     66   0.37527 0.60186 0.017485
## 23 0.00142959     78   0.34739 0.59900 0.017460
## 24 0.00107219     86   0.33595 0.60686 0.017528
## 25 0.00095306     95   0.32380 0.60972 0.017552
## 26 0.00071480     98   0.32094 0.60686 0.017528
## 27 0.00047653    111   0.31165 0.61901 0.017629
## 28 0.00042888    114   0.31022 0.62330 0.017664
## 29 0.00035740    122   0.30450 0.62831 0.017705
## 30 0.00017870    130   0.30164 0.62831 0.017705
## 31 0.00000000    134   0.30093 0.62902 0.017710
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1401/2896 = 0.48377
## 
## n= 2896 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05638829      0   1.00000 1.00000 0.019196
## 2  0.04354033      1   0.94361 0.98501 0.019185
## 3  0.03426124      2   0.90007 0.90435 0.019055
## 4  0.02831311      3   0.86581 0.86581 0.018951
## 5  0.02212705      6   0.78087 0.79300 0.018678
## 6  0.01820128      8   0.73662 0.74661 0.018451
## 7  0.01784440     10   0.70021 0.74590 0.018447
## 8  0.01641685     11   0.68237 0.73947 0.018412
## 9  0.01427552     12   0.66595 0.72520 0.018331
## 10 0.01284797     14   0.63740 0.72305 0.018319
## 11 0.00999286     15   0.62455 0.69450 0.018143
## 12 0.00963597     16   0.61456 0.66809 0.017965
## 13 0.00832739     18   0.59529 0.64882 0.017826
## 14 0.00618606     23   0.54818 0.62741 0.017661
## 15 0.00571021     27   0.52320 0.62527 0.017644
## 16 0.00535332     31   0.50036 0.63812 0.017744
## 17 0.00499643     35   0.47395 0.63812 0.017744
## 18 0.00392577     40   0.44897 0.62884 0.017672
## 19 0.00380680     44   0.43326 0.63597 0.017728
## 20 0.00356888     47   0.42184 0.63669 0.017733
## 21 0.00321199     48   0.41827 0.63526 0.017722
## 22 0.00285510     52   0.40542 0.62384 0.017632
## 23 0.00237925     54   0.39971 0.62598 0.017649
## 24 0.00214133     57   0.39258 0.63098 0.017689
## 25 0.00190340     67   0.36902 0.62313 0.017627
## 26 0.00178444     70   0.36331 0.61956 0.017598
## 27 0.00142755     72   0.35974 0.62027 0.017604
## 28 0.00107066     85   0.33833 0.62598 0.017649
## 29 0.00083274     87   0.33619 0.63098 0.017689
## 30 0.00071378     95   0.32905 0.64097 0.017766
## 31 0.00035689    106   0.32120 0.65025 0.017836
## 32 0.00000000    118   0.31692 0.65667 0.017883
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1407/2909 = 0.48367
## 
## n= 2909 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05472637      0   1.00000 1.00000 0.019156
## 2  0.05188344      1   0.94527 1.03198 0.019167
## 3  0.03411514      3   0.84151 0.89765 0.019000
## 4  0.02558635      5   0.77328 0.85928 0.018892
## 5  0.02132196      6   0.74769 0.78038 0.018582
## 6  0.01966359      7   0.72637 0.75622 0.018463
## 7  0.01776830     10   0.66738 0.75195 0.018441
## 8  0.00888415     11   0.64961 0.71642 0.018241
## 9  0.00805496     13   0.63184 0.64463 0.017757
## 10 0.00710732     18   0.58493 0.63397 0.017675
## 11 0.00615968     19   0.57783 0.61763 0.017545
## 12 0.00604122     23   0.54869 0.60625 0.017451
## 13 0.00533049     27   0.52452 0.61265 0.017504
## 14 0.00497512     29   0.51386 0.61976 0.017563
## 15 0.00426439     37   0.46837 0.61052 0.017487
## 16 0.00390903     40   0.45487 0.61336 0.017510
## 17 0.00379057     42   0.44705 0.61265 0.017504
## 18 0.00355366     45   0.43568 0.61336 0.017510
## 19 0.00248756     49   0.42146 0.62331 0.017591
## 20 0.00236911     55   0.40654 0.61976 0.017563
## 21 0.00213220     58   0.39943 0.62402 0.017597
## 22 0.00177683     71   0.37171 0.63255 0.017664
## 23 0.00165837     73   0.36816 0.63042 0.017648
## 24 0.00142146     77   0.36105 0.64748 0.017778
## 25 0.00118455     93   0.33760 0.65814 0.017857
## 26 0.00071073     96   0.33404 0.65245 0.017815
## 27 0.00053305    105   0.32765 0.66880 0.017933
## 28 0.00035537    113   0.32338 0.66951 0.017937
## 29 0.00000000    117   0.32196 0.67235 0.017957
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1402/2907 = 0.48228
## 
## n= 2907 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05349501      0   1.00000 1.00000 0.019216
## 2  0.04493581      1   0.94650 0.97789 0.019197
## 3  0.04386591      2   0.90157 0.94579 0.019154
## 4  0.02496434      5   0.76890 0.80243 0.018731
## 5  0.02139800      7   0.71897 0.75321 0.018495
## 6  0.01854494      9   0.67618 0.72825 0.018357
## 7  0.01640514     10   0.65763 0.70328 0.018207
## 8  0.01283880     11   0.64123 0.69258 0.018138
## 9  0.00927247     12   0.62839 0.68402 0.018081
## 10 0.00713267     15   0.60057 0.64408 0.017796
## 11 0.00606277     22   0.53709 0.62696 0.017663
## 12 0.00570613     24   0.52496 0.62839 0.017674
## 13 0.00534950     26   0.51355 0.62696 0.017663
## 14 0.00499287     32   0.47860 0.62625 0.017657
## 15 0.00392297     41   0.43153 0.61983 0.017605
## 16 0.00356633     43   0.42368 0.62411 0.017640
## 17 0.00309082     45   0.41655 0.62839 0.017674
## 18 0.00285307     48   0.40728 0.62268 0.017628
## 19 0.00249643     57   0.38017 0.62340 0.017634
## 20 0.00213980     61   0.37019 0.61198 0.017541
## 21 0.00178317     68   0.35449 0.60770 0.017505
## 22 0.00166429     70   0.35093 0.60842 0.017511
## 23 0.00142653     77   0.33880 0.61412 0.017558
## 24 0.00118878     86   0.32525 0.61484 0.017564
## 25 0.00106990     90   0.31954 0.61484 0.017564
## 26 0.00071327    100   0.30884 0.61626 0.017576
## 27 0.00047551    111   0.30100 0.63195 0.017702
## 28 0.00035663    114   0.29957 0.63195 0.017702
## 29 0.00023776    118   0.29815 0.62981 0.017685
## 30 0.00017832    121   0.29743 0.63409 0.017719
## 31 0.00000000    125   0.29672 0.63267 0.017708
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1398/2910 = 0.48041
## 
## n= 2910 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04971388      0   1.00000 1.00000 0.019279
## 2  0.04041488      2   0.90057 0.97210 0.019251
## 3  0.02718169      5   0.77611 0.83047 0.018895
## 4  0.02467811      6   0.74893 0.81974 0.018853
## 5  0.02217454      8   0.69957 0.79614 0.018753
## 6  0.01788269      9   0.67740 0.76753 0.018617
## 7  0.00977587     10   0.65951 0.70386 0.018255
## 8  0.00858369     13   0.63019 0.67310 0.018049
## 9  0.00608011     18   0.58226 0.65594 0.017926
## 10 0.00572246     20   0.57010 0.63805 0.017791
## 11 0.00536481     24   0.53934 0.62804 0.017712
## 12 0.00500715     26   0.52861 0.62876 0.017717
## 13 0.00482833     33   0.48784 0.62661 0.017700
## 14 0.00476872     37   0.46853 0.62661 0.017700
## 15 0.00464950     40   0.45422 0.61516 0.017606
## 16 0.00429185     42   0.44492 0.61516 0.017606
## 17 0.00393419     43   0.44063 0.62017 0.017648
## 18 0.00357654     45   0.43276 0.62375 0.017677
## 19 0.00321888     47   0.42561 0.61445 0.017601
## 20 0.00286123     49   0.41917 0.61445 0.017601
## 21 0.00250358     57   0.39557 0.61874 0.017636
## 22 0.00214592     64   0.37768 0.61230 0.017583
## 23 0.00143062     74   0.35622 0.61660 0.017618
## 24 0.00107296     95   0.32546 0.64020 0.017807
## 25 0.00095374    101   0.31903 0.64950 0.017878
## 26 0.00071531    104   0.31617 0.64950 0.017878
## 27 0.00035765    114   0.30901 0.66023 0.017958
## 28 0.00000000    120   0.30687 0.66166 0.017968
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1404/2913 = 0.48198
## 
## n= 2913 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05128205      0   1.00000 1.00000 0.019208
## 2  0.03276353      2   0.89744 0.93376 0.019125
## 3  0.02849003      3   0.86467 0.85541 0.018923
## 4  0.02101140      6   0.77920 0.81553 0.018776
## 5  0.01887464      8   0.73718 0.75855 0.018513
## 6  0.01780627     10   0.69943 0.74573 0.018446
## 7  0.01495726     11   0.68162 0.73433 0.018382
## 8  0.01460114     12   0.66667 0.73433 0.018382
## 9  0.01139601     14   0.63746 0.71652 0.018278
## 10 0.01068376     15   0.62607 0.70085 0.018181
## 11 0.00961538     16   0.61538 0.69587 0.018149
## 12 0.00878443     18   0.59615 0.67379 0.018002
## 13 0.00712251     23   0.54772 0.66524 0.017942
## 14 0.00534188     27   0.51923 0.63390 0.017707
## 15 0.00498575     31   0.49786 0.63675 0.017730
## 16 0.00462963     38   0.45869 0.63390 0.017707
## 17 0.00427350     42   0.44017 0.63462 0.017713
## 18 0.00391738     44   0.43162 0.62749 0.017657
## 19 0.00379867     46   0.42379 0.63960 0.017752
## 20 0.00356125     49   0.41239 0.63960 0.017752
## 21 0.00284900     50   0.40883 0.63960 0.017752
## 22 0.00249288     56   0.39174 0.63675 0.017730
## 23 0.00213675     58   0.38675 0.62607 0.017645
## 24 0.00189934     64   0.37393 0.62393 0.017628
## 25 0.00178063     67   0.36823 0.61966 0.017594
## 26 0.00166192     69   0.36467 0.61966 0.017594
## 27 0.00142450     76   0.35256 0.62607 0.017645
## 28 0.00124644     87   0.33689 0.62536 0.017640
## 29 0.00118708     91   0.33191 0.62678 0.017651
## 30 0.00106838     94   0.32835 0.62393 0.017628
## 31 0.00071225     96   0.32621 0.62749 0.017657
## 32 0.00035613    109   0.31695 0.64601 0.017800
## 33 0.00000000    117   0.31410 0.65313 0.017854
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1397/2908 = 0.4804
## 
## n= 2908 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04974946      0   1.00000 1.00000 0.019286
## 2  0.03149606      2   0.90050 0.94846 0.019224
## 3  0.02791696      3   0.86901 0.90336 0.019132
## 4  0.01968504      6   0.78525 0.80816 0.018812
## 5  0.01789549      8   0.74588 0.77738 0.018672
## 6  0.01360057      9   0.72799 0.74517 0.018506
## 7  0.01145311     13   0.65927 0.71439 0.018327
## 8  0.01073729     14   0.64782 0.69363 0.018195
## 9  0.00966356     19   0.59413 0.68146 0.018114
## 10 0.00715820     21   0.57480 0.66929 0.018029
## 11 0.00644238     26   0.52613 0.65999 0.017962
## 12 0.00536865     28   0.51324 0.65283 0.017910
## 13 0.00501074     30   0.50251 0.65354 0.017915
## 14 0.00465283     38   0.45812 0.64853 0.017877
## 15 0.00429492     44   0.43021 0.64925 0.017883
## 16 0.00357910     46   0.42162 0.63493 0.017773
## 17 0.00286328     50   0.40730 0.64352 0.017839
## 18 0.00250537     51   0.40444 0.62992 0.017733
## 19 0.00238607     53   0.39943 0.62777 0.017716
## 20 0.00214746     56   0.39227 0.63350 0.017761
## 21 0.00178955     61   0.38082 0.63851 0.017801
## 22 0.00167025     65   0.37366 0.63708 0.017789
## 23 0.00143164     72   0.36149 0.65784 0.017947
## 24 0.00107373     89   0.33644 0.65569 0.017931
## 25 0.00071582     91   0.33429 0.65927 0.017957
## 26 0.00040904    103   0.32570 0.67645 0.018079
## 27 0.00035791    111   0.32140 0.67072 0.018039
## 28 0.00023861    119   0.31854 0.67001 0.018034
## 29 0.00017895    122   0.31782 0.66571 0.018004
## 30 0.00000000    126   0.31711 0.66500 0.017999
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1400/2914 = 0.48044
## 
## n= 2914 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04821429      0   1.00000 1.00000 0.019264
## 2  0.03285714      2   0.90357 0.92000 0.019149
## 3  0.02809524      3   0.87071 0.86429 0.019000
## 4  0.01892857      6   0.78643 0.79500 0.018734
## 5  0.01785714      8   0.74857 0.75643 0.018546
## 6  0.01321429      9   0.73071 0.74500 0.018484
## 7  0.01142857     13   0.66357 0.73357 0.018420
## 8  0.01107143     16   0.62929 0.69286 0.018170
## 9  0.01071429     18   0.60714 0.69143 0.018161
## 10 0.00964286     19   0.59643 0.68929 0.018147
## 11 0.00678571     21   0.57714 0.65143 0.017880
## 12 0.00642857     26   0.52786 0.64714 0.017847
## 13 0.00535714     28   0.51500 0.64643 0.017842
## 14 0.00500000     32   0.49357 0.64429 0.017826
## 15 0.00428571     41   0.44286 0.62929 0.017709
## 16 0.00392857     43   0.43429 0.63071 0.017720
## 17 0.00357143     47   0.41857 0.63286 0.017737
## 18 0.00285714     50   0.40786 0.63071 0.017720
## 19 0.00250000     51   0.40500 0.63857 0.017782
## 20 0.00238095     53   0.40000 0.63429 0.017748
## 21 0.00214286     56   0.39286 0.63071 0.017720
## 22 0.00166667     64   0.37500 0.63071 0.017720
## 23 0.00142857     71   0.36286 0.64714 0.017847
## 24 0.00119048     86   0.34000 0.65214 0.017885
## 25 0.00107143     89   0.33643 0.65857 0.017932
## 26 0.00071429     91   0.33429 0.65786 0.017927
## 27 0.00040816    102   0.32643 0.68286 0.018103
## 28 0.00035714    110   0.32214 0.68571 0.018123
## 29 0.00023810    120   0.31857 0.68571 0.018123
## 30 0.00017857    123   0.31786 0.68500 0.018118
## 31 0.00000000    127   0.31714 0.68643 0.018128
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1399/2911 = 0.48059
## 
## n= 2911 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04717655      0   1.00000 1.00000 0.019268
## 2  0.04395997      2   0.90565 1.01573 0.019278
## 3  0.04288778      4   0.81773 0.97498 0.019245
## 4  0.02787706      5   0.77484 0.91565 0.019144
## 5  0.02251608      6   0.74696 0.82845 0.018879
## 6  0.02144389      8   0.70193 0.81630 0.018830
## 7  0.01572552      9   0.68049 0.78985 0.018715
## 8  0.01143674     10   0.66476 0.69621 0.018197
## 9  0.00953062     11   0.65332 0.67191 0.018033
## 10 0.00929235     14   0.62473 0.66405 0.017977
## 11 0.00822016     15   0.61544 0.64832 0.017861
## 12 0.00786276     17   0.59900 0.63188 0.017734
## 13 0.00714796     22   0.54896 0.62187 0.017654
## 14 0.00679056     24   0.53467 0.62259 0.017660
## 15 0.00571837     26   0.52109 0.61115 0.017565
## 16 0.00500357     30   0.49035 0.61472 0.017595
## 17 0.00482487     33   0.47534 0.61330 0.017583
## 18 0.00464618     37   0.45604 0.60543 0.017517
## 19 0.00357398     39   0.44675 0.60686 0.017529
## 20 0.00321658     41   0.43960 0.61615 0.017607
## 21 0.00285919     43   0.43317 0.60972 0.017553
## 22 0.00250179     47   0.42173 0.60400 0.017505
## 23 0.00238265     52   0.40743 0.60472 0.017511
## 24 0.00214439     55   0.40029 0.61472 0.017595
## 25 0.00160829     66   0.37598 0.61830 0.017625
## 26 0.00142959     71   0.36741 0.62974 0.017717
## 27 0.00119133     81   0.35311 0.62974 0.017717
## 28 0.00107219     84   0.34954 0.63545 0.017762
## 29 0.00095306     91   0.34167 0.63402 0.017751
## 30 0.00071480    100   0.33310 0.63545 0.017762
## 31 0.00035740    114   0.32309 0.64904 0.017867
## 32 0.00000000    120   0.32094 0.66119 0.017956
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1395/2911 = 0.47922
## 
## n= 2911 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04946237      0   1.00000 1.00000 0.019322
## 2  0.03297491      2   0.90108 0.94982 0.019260
## 3  0.02700119      3   0.86810 0.90036 0.019156
## 4  0.02078853      6   0.78710 0.80717 0.018836
## 5  0.01863799      8   0.74552 0.78065 0.018715
## 6  0.01792115     11   0.68961 0.75842 0.018603
## 7  0.01433692     12   0.67168 0.75269 0.018573
## 8  0.01290323     14   0.64301 0.74409 0.018526
## 9  0.01003584     15   0.63011 0.70968 0.018323
## 10 0.00967742     16   0.62007 0.69677 0.018240
## 11 0.00860215     18   0.60072 0.67599 0.018100
## 12 0.00681004     23   0.55125 0.64803 0.017896
## 13 0.00573477     27   0.52258 0.64229 0.017852
## 14 0.00544803     29   0.51111 0.64516 0.017874
## 15 0.00537634     35   0.47742 0.65090 0.017918
## 16 0.00501792     37   0.46667 0.65161 0.017923
## 17 0.00430108     40   0.45161 0.64659 0.017885
## 18 0.00394265     41   0.44731 0.64731 0.017891
## 19 0.00382318     45   0.43154 0.64158 0.017847
## 20 0.00358423     48   0.42007 0.64158 0.017847
## 21 0.00322581     51   0.40932 0.64086 0.017841
## 22 0.00286738     53   0.40287 0.64014 0.017836
## 23 0.00250896     55   0.39713 0.63441 0.017791
## 24 0.00238949     57   0.39211 0.63441 0.017791
## 25 0.00215054     60   0.38495 0.63154 0.017768
## 26 0.00179211     65   0.37348 0.61935 0.017669
## 27 0.00167264     69   0.36631 0.61720 0.017652
## 28 0.00143369     76   0.35412 0.61649 0.017646
## 29 0.00107527     89   0.33548 0.61720 0.017652
## 30 0.00071685     93   0.33118 0.61290 0.017616
## 31 0.00035842    106   0.32186 0.62007 0.017675
## 32 0.00000000    114   0.31900 0.62366 0.017705
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1393/2902 = 0.48001
## 
## n= 2902 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05264417      0   1.00000 1.00000 0.019321
## 2  0.03732950      3   0.84207 0.94616 0.019255
## 3  0.01794688      4   0.80474 0.84135 0.018975
## 4  0.01220388      5   0.78679 0.76167 0.018625
## 5  0.01148600     10   0.72362 0.71429 0.018356
## 6  0.00969131     15   0.63819 0.69706 0.018247
## 7  0.00933238     17   0.61881 0.69706 0.018247
## 8  0.00861450     19   0.60014 0.69490 0.018233
## 9  0.00753769     24   0.55492 0.66834 0.018052
## 10 0.00681981     26   0.53984 0.64752 0.017899
## 11 0.00646088     30   0.51256 0.64465 0.017877
## 12 0.00574300     31   0.50610 0.63245 0.017782
## 13 0.00538406     33   0.49462 0.62096 0.017689
## 14 0.00502513     35   0.48385 0.62168 0.017695
## 15 0.00466619     36   0.47882 0.61522 0.017642
## 16 0.00430725     38   0.46949 0.60804 0.017581
## 17 0.00358938     40   0.46088 0.61737 0.017659
## 18 0.00287150     44   0.44652 0.62958 0.017759
## 19 0.00263221     50   0.42714 0.62814 0.017747
## 20 0.00251256     57   0.40775 0.62742 0.017741
## 21 0.00215363     63   0.39268 0.62814 0.017747
## 22 0.00179469     73   0.36899 0.63245 0.017782
## 23 0.00167504     75   0.36540 0.63819 0.017827
## 24 0.00143575     81   0.35535 0.63029 0.017764
## 25 0.00107681     93   0.33812 0.63173 0.017776
## 26 0.00071788     99   0.33166 0.64250 0.017860
## 27 0.00043073    112   0.32233 0.64752 0.017899
## 28 0.00035894    119   0.31874 0.65973 0.017990
## 29 0.00000000    121   0.31802 0.66619 0.018036
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1399/2908 = 0.48109
## 
## n= 2908 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.04932094      0   1.00000 1.00000 0.019259
## 2  0.03359543      2   0.90136 0.95068 0.019203
## 3  0.02740052      3   0.86776 0.88277 0.019053
## 4  0.02251608      6   0.78556 0.80272 0.018767
## 5  0.01965690      8   0.74053 0.77055 0.018617
## 6  0.01858470     10   0.70122 0.75411 0.018533
## 7  0.01501072     11   0.68263 0.71837 0.018331
## 8  0.01036455     14   0.63760 0.69550 0.018188
## 9  0.00964975     16   0.61687 0.68192 0.018098
## 10 0.00786276     18   0.59757 0.65618 0.017916
## 11 0.00619490     23   0.55111 0.62545 0.017679
## 12 0.00607577     27   0.52609 0.62473 0.017673
## 13 0.00571837     31   0.49821 0.62187 0.017650
## 14 0.00500357     35   0.47534 0.62187 0.017650
## 15 0.00464618     38   0.46033 0.62044 0.017638
## 16 0.00428878     40   0.45104 0.61187 0.017568
## 17 0.00393138     41   0.44675 0.61258 0.017574
## 18 0.00381225     43   0.43888 0.61687 0.017609
## 19 0.00357398     46   0.42745 0.61472 0.017591
## 20 0.00285919     50   0.41315 0.61115 0.017562
## 21 0.00250179     52   0.40743 0.59900 0.017458
## 22 0.00238265     55   0.39957 0.59900 0.017458
## 23 0.00214439     58   0.39242 0.60186 0.017483
## 24 0.00178699     66   0.37384 0.60543 0.017513
## 25 0.00166786     69   0.36741 0.60186 0.017483
## 26 0.00142959     72   0.36240 0.61544 0.017597
## 27 0.00119133     87   0.33810 0.61544 0.017597
## 28 0.00107219     90   0.33452 0.61687 0.017609
## 29 0.00083393     98   0.32595 0.61973 0.017633
## 30 0.00071480    106   0.31880 0.63259 0.017736
## 31 0.00035740    118   0.31022 0.64689 0.017846
## 32 0.00000000    128   0.30665 0.65189 0.017884
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1402/2916 = 0.4808
## 
## n= 2916 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05064194      0   1.00000 1.00000 0.019244
## 2  0.03922967      2   0.89872 0.97932 0.019225
## 3  0.02924394      5   0.77817 0.85093 0.018937
## 4  0.02353780      6   0.74893 0.81740 0.018812
## 5  0.02211127      8   0.70185 0.80528 0.018761
## 6  0.01783167      9   0.67974 0.77603 0.018628
## 7  0.01022349     10   0.66191 0.70399 0.018226
## 8  0.00879696     13   0.63124 0.66690 0.017977
## 9  0.00677603     18   0.58274 0.62767 0.017680
## 10 0.00618165     20   0.56919 0.62411 0.017652
## 11 0.00570613     24   0.53709 0.63195 0.017714
## 12 0.00499287     26   0.52568 0.63053 0.017703
## 13 0.00481455     33   0.48573 0.63409 0.017731
## 14 0.00463623     37   0.46648 0.62981 0.017697
## 15 0.00451736     39   0.45720 0.62981 0.017697
## 16 0.00427960     42   0.44365 0.62839 0.017686
## 17 0.00356633     43   0.43937 0.62197 0.017634
## 18 0.00320970     45   0.43224 0.62340 0.017646
## 19 0.00309082     51   0.41298 0.62482 0.017657
## 20 0.00285307     55   0.40014 0.62482 0.017657
## 21 0.00213980     63   0.37660 0.62197 0.017634
## 22 0.00178317     74   0.35235 0.62625 0.017669
## 23 0.00166429     76   0.34879 0.62268 0.017640
## 24 0.00142653     80   0.34165 0.62268 0.017640
## 25 0.00106990     93   0.32311 0.62054 0.017623
## 26 0.00071327    101   0.31455 0.62910 0.017692
## 27 0.00059439    114   0.30528 0.64622 0.017825
## 28 0.00035663    120   0.30171 0.64765 0.017835
## 29 0.00000000    122   0.30100 0.66334 0.017951
## 
## Classification tree:
## rpart(formula = ChangeOpening ~ avg.senti + name + growth + interest.rate + 
##     unemployment + open_nasdq + assets, data = train1[train1$kfold != 
##     i, ], method = "class", cp = 0)
## 
## Variables actually used in tree construction:
## [1] assets        avg.senti     growth        interest.rate name         
## [6] open_nasdq    unemployment 
## 
## Root node error: 1397/2908 = 0.4804
## 
## n= 2908 
## 
##            CP nsplit rel error  xerror     xstd
## 1  0.05010737      0   1.00000 1.00000 0.019286
## 2  0.03507516      2   0.89979 0.90336 0.019132
## 3  0.02576951      5   0.79456 0.82606 0.018885
## 4  0.02147459      7   0.74302 0.75805 0.018575
## 5  0.01932713      8   0.72155 0.73515 0.018450
## 6  0.01789549     10   0.68289 0.71654 0.018340
## 7  0.01073729     11   0.66500 0.71439 0.018327
## 8  0.01037938     14   0.63135 0.69291 0.018191
## 9  0.00930565     16   0.61059 0.68074 0.018109
## 10 0.00858984     18   0.59198 0.67717 0.018084
## 11 0.00787402     22   0.55404 0.64996 0.017888
## 12 0.00608447     24   0.53830 0.61632 0.017622
## 13 0.00558339     26   0.52613 0.60558 0.017532
## 14 0.00501074     32   0.49177 0.60487 0.017526
## 15 0.00447387     35   0.47674 0.60845 0.017557
## 16 0.00429492     39   0.45884 0.60558 0.017532
## 17 0.00393701     44   0.43737 0.60702 0.017544
## 18 0.00357910     46   0.42949 0.60988 0.017569
## 19 0.00286328     52   0.40802 0.61346 0.017599
## 20 0.00250537     53   0.40515 0.61918 0.017646
## 21 0.00238607     55   0.40014 0.61489 0.017611
## 22 0.00229062     65   0.37581 0.59699 0.017458
## 23 0.00214746     71   0.36077 0.59699 0.017458
## 24 0.00143164     81   0.33930 0.60129 0.017495
## 25 0.00119303     89   0.32785 0.60773 0.017550
## 26 0.00107373     92   0.32427 0.61346 0.017599
## 27 0.00083512     94   0.32212 0.61346 0.017599
## 28 0.00071582    102   0.31496 0.62563 0.017699
## 29 0.00035791    106   0.31210 0.63422 0.017767
## 30 0.00023861    110   0.31067 0.63851 0.017801
## 31 0.00000000    113   0.30995 0.63994 0.017812
#View(meanf1.firm29)

#Set a data frame the same long as 29 firms
x2 <- as.data.frame(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,
                      20, 21, 22, 23, 24, 25, 26, 27, 28, 29))
colnames(x2) <- c("number")
meanf1.firm29 <- cbind(meanf1.firm29, x2)

#Total companies' name, their decision tree variable importance, and their meanf1
company.importance.total <- merge(company.importance, meanf1.firm29, by = "number")
company.importance.total1 <- company.importance.total[, -3]
company.importance.total2 <- cbind(company.importance.total1, tree.firm29)[, -5]
#View(company.importance.total2)

company.importance.total2$names <- rownames(company.importance.total2)

#Chart of meanf1 and variable importance in each firm
company.importance.total3 <- data.frame(names = row.names(company.importance.total2), company.importance.total2)[, -6]
company.importance.total3
##                           names number firm    meanf1 importance
## avg.senti             avg.senti      1 AAPL 0.7330988 287.287989
## open_nasdq           open_nasdq      1 AAPL 0.7330988 266.844724
## unemployment       unemployment      1 AAPL 0.7330988 137.180346
## growth                   growth      1 AAPL 0.7330988  83.420415
## interest.rate     interest.rate      1 AAPL 0.7330988  25.907394
## assets                   assets      1 AAPL 0.7330988   4.223363
## avg.senti1           avg.senti1      2  AXP 0.6836941 264.821893
## open_nasdq1         open_nasdq1      2  AXP 0.6836941 242.725414
## unemployment1     unemployment1      2  AXP 0.6836941 145.959689
## growth1                 growth1      2  AXP 0.6836941  71.089889
## interest.rate1   interest.rate1      2  AXP 0.6836941  32.603784
## assets1                 assets1      2  AXP 0.6836941   2.759345
## avg.senti2           avg.senti2      3   BA 0.7304052 314.473078
## open_nasdq2         open_nasdq2      3   BA 0.7304052 305.835109
## unemployment2     unemployment2      3   BA 0.7304052 155.234989
## growth2                 growth2      3   BA 0.7304052 117.426042
## assets2                 assets2      3   BA 0.7304052  41.301305
## interest.rate2   interest.rate2      3   BA 0.7304052  39.706612
## avg.senti3           avg.senti3      4  CAT 0.7196448 314.468021
## open_nasdq3         open_nasdq3      4  CAT 0.7196448 295.409696
## unemployment3     unemployment3      4  CAT 0.7196448 173.830916
## growth3                 growth3      4  CAT 0.7196448 114.138578
## assets3                 assets3      4  CAT 0.7196448  64.597795
## interest.rate3   interest.rate3      4  CAT 0.7196448  54.358933
## avg.senti4           avg.senti4      5 CSCO 0.7363373 300.607310
## open_nasdq4         open_nasdq4      5 CSCO 0.7363373 256.239007
## unemployment4     unemployment4      5 CSCO 0.7363373 113.011827
## growth4                 growth4      5 CSCO 0.7363373 105.799921
## interest.rate4   interest.rate4      5 CSCO 0.7363373  18.578312
## assets4                 assets4      5 CSCO 0.7363373   2.673690
## avg.senti5           avg.senti5      6  CVX 0.7144549 318.301116
## open_nasdq5         open_nasdq5      6  CVX 0.7144549 317.189012
## unemployment5     unemployment5      6  CVX 0.7144549 169.753709
## growth5                 growth5      6  CVX 0.7144549 121.277564
## interest.rate5   interest.rate5      6  CVX 0.7144549  51.134368
## assets5                 assets5      6  CVX 0.7144549  48.737296
## avg.senti6           avg.senti6      7  DIS 0.6238881 334.535311
## open_nasdq6         open_nasdq6      7  DIS 0.6238881 331.547060
## unemployment6     unemployment6      7  DIS 0.6238881 175.317081
## growth6                 growth6      7  DIS 0.6238881 121.462415
## interest.rate6   interest.rate6      7  DIS 0.6238881  58.841040
## assets6                 assets6      7  DIS 0.6238881  56.171961
## avg.senti7           avg.senti7      8   GE 0.7218679 268.847990
## open_nasdq7         open_nasdq7      8   GE 0.7218679 257.373763
## unemployment7     unemployment7      8   GE 0.7218679 109.215700
## growth7                 growth7      8   GE 0.7218679  92.232187
## interest.rate7   interest.rate7      8   GE 0.7218679  29.643269
## assets7                 assets7      8   GE 0.7218679   3.021778
## avg.senti8           avg.senti8      9   GS 0.7353169 320.897726
## open_nasdq8         open_nasdq8      9   GS 0.7353169 307.450667
## unemployment8     unemployment8      9   GS 0.7353169 165.975177
## growth8                 growth8      9   GS 0.7353169  99.358967
## assets8                 assets8      9   GS 0.7353169  50.739697
## interest.rate8   interest.rate8      9   GS 0.7353169  48.683221
## avg.senti9           avg.senti9     10   HD 0.7014603 346.235505
## open_nasdq9         open_nasdq9     10   HD 0.7014603 308.524041
## unemployment9     unemployment9     10   HD 0.7014603 127.847690
## growth9                 growth9     10   HD 0.7014603 123.457058
## assets9                 assets9     10   HD 0.7014603  72.934998
## interest.rate9   interest.rate9     10   HD 0.7014603  31.922088
## avg.senti10         avg.senti10     11  IBM 0.7098763 221.160268
## open_nasdq10       open_nasdq10     11  IBM 0.7098763 167.955997
## unemployment10   unemployment10     11  IBM 0.7098763  81.596020
## growth10               growth10     11  IBM 0.7098763  63.003210
## interest.rate10 interest.rate10     11  IBM 0.7098763  23.581584
## assets10               assets10     11  IBM 0.7098763   1.945120
## avg.senti11         avg.senti11     12 INTC 0.7339939 351.234370
## open_nasdq11       open_nasdq11     12 INTC 0.7339939 340.239259
## unemployment11   unemployment11     12 INTC 0.7339939 173.743238
## growth11               growth11     12 INTC 0.7339939 123.508917
## assets11               assets11     12 INTC 0.7339939  58.619627
## interest.rate11 interest.rate11     12 INTC 0.7339939  58.402922
## avg.senti12         avg.senti12     13  JNJ 0.7441116 348.873517
## open_nasdq12       open_nasdq12     13  JNJ 0.7441116 317.648566
## unemployment12   unemployment12     13  JNJ 0.7441116 170.062814
## growth12               growth12     13  JNJ 0.7441116 150.969926
## interest.rate12 interest.rate12     13  JNJ 0.7441116  73.813509
## assets12               assets12     13  JNJ 0.7441116  69.722529
## open_nasdq13       open_nasdq13     14  JPM 0.7349228 316.631055
## avg.senti13         avg.senti13     14  JPM 0.7349228 289.067512
## unemployment13   unemployment13     14  JPM 0.7349228 152.544951
## growth13               growth13     14  JPM 0.7349228  95.150065
## assets13               assets13     14  JPM 0.7349228  48.489932
## interest.rate13 interest.rate13     14  JPM 0.7349228  48.398583
## open_nasdq14       open_nasdq14     15   KO 0.6659075 322.199218
## avg.senti14         avg.senti14     15   KO 0.6659075 230.084083
## unemployment14   unemployment14     15   KO 0.6659075 137.851485
## growth14               growth14     15   KO 0.6659075 125.760345
## interest.rate14 interest.rate14     15   KO 0.6659075  25.833422
## assets14               assets14     15   KO 0.6659075   9.002192
## avg.senti15         avg.senti15     16  MCD 0.7337445 277.527829
## open_nasdq15       open_nasdq15     16  MCD 0.7337445 263.935935
## unemployment15   unemployment15     16  MCD 0.7337445 125.739917
## growth15               growth15     16  MCD 0.7337445  85.210357
## interest.rate15 interest.rate15     16  MCD 0.7337445  35.906274
## assets15               assets15     16  MCD 0.7337445   2.531936
## avg.senti16         avg.senti16     17  MMM 0.7371511 290.493157
## open_nasdq16       open_nasdq16     17  MMM 0.7371511 270.573259
## unemployment16   unemployment16     17  MMM 0.7371511 136.675550
## growth16               growth16     17  MMM 0.7371511 102.504179
## interest.rate16 interest.rate16     17  MMM 0.7371511  59.764809
## assets16               assets16     17  MMM 0.7371511   4.199760
## avg.senti17         avg.senti17     18  MRK 0.7474097 292.798336
## open_nasdq17       open_nasdq17     18  MRK 0.7474097 279.689257
## unemployment17   unemployment17     18  MRK 0.7474097 145.869573
## growth17               growth17     18  MRK 0.7474097  97.622633
## interest.rate17 interest.rate17     18  MRK 0.7474097  42.936372
## assets17               assets17     18  MRK 0.7474097  16.813017
## avg.senti18         avg.senti18     19 MSFT 0.7273715 316.857234
## open_nasdq18       open_nasdq18     19 MSFT 0.7273715 314.124478
## unemployment18   unemployment18     19 MSFT 0.7273715 152.050470
## growth18               growth18     19 MSFT 0.7273715 125.453004
## interest.rate18 interest.rate18     19 MSFT 0.7273715  37.603582
## assets18               assets18     19 MSFT 0.7273715  37.400219
## avg.senti19         avg.senti19     20  NKE 0.7272939 273.326102
## open_nasdq19       open_nasdq19     20  NKE 0.7272939 256.904936
## unemployment19   unemployment19     20  NKE 0.7272939 121.662103
## growth19               growth19     20  NKE 0.7272939  83.362005
## interest.rate19 interest.rate19     20  NKE 0.7272939  36.068231
## assets19               assets19     20  NKE 0.7272939   2.894641
## avg.senti20         avg.senti20     21  PFE 0.7405817 297.604426
## open_nasdq20       open_nasdq20     21  PFE 0.7405817 275.509893
## unemployment20   unemployment20     21  PFE 0.7405817 133.369278
## growth20               growth20     21  PFE 0.7405817 108.778450
## interest.rate20 interest.rate20     21  PFE 0.7405817  58.008635
## assets20               assets20     21  PFE 0.7405817   3.485888
## open_nasdq21       open_nasdq21     22   PG 0.7559156 302.998769
## avg.senti21         avg.senti21     22   PG 0.7559156 284.680376
## unemployment21   unemployment21     22   PG 0.7559156 170.505949
## growth21               growth21     22   PG 0.7559156 104.509720
## interest.rate21 interest.rate21     22   PG 0.7559156  32.566507
## assets21               assets21     22   PG 0.7559156  10.992463
## open_nasdq22       open_nasdq22     23  TRV 0.7148841 307.951840
## avg.senti22         avg.senti22     23  TRV 0.7148841 293.394993
## unemployment22   unemployment22     23  TRV 0.7148841 157.820174
## growth22               growth22     23  TRV 0.7148841 118.607324
## interest.rate22 interest.rate22     23  TRV 0.7148841  36.537328
## assets22               assets22     23  TRV 0.7148841  12.883326
## open_nasdq23       open_nasdq23     24  UNH 0.7429216 296.206621
## avg.senti23         avg.senti23     24  UNH 0.7429216 295.116832
## unemployment23   unemployment23     24  UNH 0.7429216 152.305989
## growth23               growth23     24  UNH 0.7429216  96.356692
## interest.rate23 interest.rate23     24  UNH 0.7429216  37.457614
## assets23               assets23     24  UNH 0.7429216  13.062086
## avg.senti24         avg.senti24     25  UTX 0.7146964 292.353421
## open_nasdq24       open_nasdq24     25  UTX 0.7146964 274.985661
## unemployment24   unemployment24     25  UTX 0.7146964 136.505811
## growth24               growth24     25  UTX 0.7146964 111.163086
## interest.rate24 interest.rate24     25  UTX 0.7146964  59.061917
## assets24               assets24     25  UTX 0.7146964   3.418517
## open_nasdq25       open_nasdq25     26    V 0.7278084 338.183169
## avg.senti25         avg.senti25     26    V 0.7278084 248.190937
## unemployment25   unemployment25     26    V 0.7278084 173.721467
## growth25               growth25     26    V 0.7278084 126.367509
## assets25               assets25     26    V 0.7278084  54.028509
## interest.rate25 interest.rate25     26    V 0.7278084  26.177560
## avg.senti26         avg.senti26     27   VZ 0.7511200 294.633111
## open_nasdq26       open_nasdq26     27   VZ 0.7511200 272.587468
## unemployment26   unemployment26     27   VZ 0.7511200 140.454566
## growth26               growth26     27   VZ 0.7511200 114.053510
## interest.rate26 interest.rate26     27   VZ 0.7511200  61.176454
## assets26               assets26     27   VZ 0.7511200   6.229428
## avg.senti27         avg.senti27     28  WMT 0.7263684 298.255815
## open_nasdq27       open_nasdq27     28  WMT 0.7263684 283.891807
## unemployment27   unemployment27     28  WMT 0.7263684 137.518637
## growth27               growth27     28  WMT 0.7263684  92.748418
## interest.rate27 interest.rate27     28  WMT 0.7263684  42.951666
## assets27               assets27     28  WMT 0.7263684   5.755101
## open_nasdq28       open_nasdq28     29  XOM 0.7588351 324.854728
## avg.senti28         avg.senti28     29  XOM 0.7588351 316.064566
## unemployment28   unemployment28     29  XOM 0.7588351 169.490442
## growth28               growth28     29  XOM 0.7588351 120.554747
## interest.rate28 interest.rate28     29  XOM 0.7588351  69.612956
## assets28               assets28     29  XOM 0.7588351  54.329105
Data Visualization II
Topic Modeling
Following the topic modeling that categorize all the key words in the headlines into different topic groups.

####################
###TOPIC MODELING###
####################

#Count words
news.count <- news %>%
  unnest_tokens(word, abstract) %>%
  count(date, word, sort = TRUE)  %>%
  anti_join(stop_words)
#Calculate TF-IDF
news.count <- news.count %>%
  bind_tf_idf(word, date, n)

#News.count by year
news.count1 <- subset(news.count, news.count$date <= "2014-12-31")
news.count2 <- subset(news.count, news.count$date >= "2015-1-1" & news.count$date <= "2015-12-31")
news.count3 <- subset(news.count, news.count$date >= "2016-1-1" & news.count$date <= "2016-12-31")
news.count4 <- subset(news.count, news.count$date >= "2017-1-1" & news.count$date <= "2017-12-31")

#######################
#Topic Modeling in 2014
week <- c("monday","tuesday","wednesday","thursday","friday","saturday","sunday")
for (i in week){
  news.count1 <- subset(news.count1, news.count1$word != i)
}

year <- c("jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "sept", "oct",
          "nov", "dec", "january", "february", "march", "april", "may", "june",
          "july", "august", "september", "october","november", "december")
for (j in year){
  news.count1 <- subset(news.count1, news.count1$word != j)
}

#Keep top 10 TFIDF by group
news.count.top1 <- news.count1 %>%
  group_by(date) %>%
  top_n(n = 10, wt = tf_idf)
#Create Document Term Matrix
news.matrix1 <- news.count.top1 %>% cast_dtm(date, word, n)

#LDA
library(topicmodels)
library(ggplot2)

##LDA: Latent Dirichlet Allocaiton
#Run LDA
tal_lda1 <- LDA(news.matrix1, k = 6, control = list(seed = 1234))
tal_top1 <- tidy(tal_lda1, matrix = "beta")

#
tal_top_terms1 <- tal_top1 %>%
  group_by(topic) %>%
  top_n(10, beta) %>%
  ungroup() %>%
  arrange(topic, -beta)

tal_top_terms1 %>%
  mutate(term = reorder(term, beta)) %>%
  ggplot(aes(term, beta, fill = factor(topic))) +
  geom_col(show.legend = FALSE) + 
  theme(text = element_text(size=10)) +
  facet_wrap(~ topic, scales = "free") +
  coord_flip()


#######################
#Topic Modeling in 2015
week <- c("monday","tuesday","wednesday","thursday","friday","saturday","sunday")
for (i in week){
  news.count2 <- subset(news.count2, news.count2$word != i)
}

year <- c("jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "sept", "oct",
          "nov", "dec", "january", "february", "march", "april", "may", "june",
          "july", "august", "september", "october","november", "december")
for (j in year){
  news.count2 <- subset(news.count2, news.count2$word != j)
}

#Keep top 10 TFIDF by group
news.count.top2 <- news.count2 %>%
  group_by(date) %>%
  top_n(n = 10, wt = tf_idf)
#Create Document Term Matrix
news.matrix2 <- news.count.top2 %>% cast_dtm(date, word, n)

#LDA
library(topicmodels)
library(ggplot2)

##LDA: Latent Dirichlet Allocaiton
#Run LDA
tal_lda2 <- LDA(news.matrix2, k = 6, control = list(seed = 1234))
tal_top2 <- tidy(tal_lda2, matrix = "beta")

#
tal_top_terms2 <- tal_top2 %>%
  group_by(topic) %>%
  top_n(10, beta) %>%
  ungroup() %>%
  arrange(topic, -beta)

tal_top_terms2 %>%
  mutate(term = reorder(term, beta)) %>%
  ggplot(aes(term, beta, fill = factor(topic))) +
  geom_col(show.legend = FALSE) + 
  theme(text = element_text(size=10)) +
  facet_wrap(~ topic, scales = "free") +
  coord_flip()


#######################
#Topic Modeling in 2016
week <- c("monday","tuesday","wednesday","thursday","friday","saturday","sunday")
for (i in week){
  news.count3 <- subset(news.count3, news.count3$word != i)
}

year <- c("jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "sept", "oct",
          "nov", "dec", "january", "february", "march", "april", "may", "june",
          "july", "august", "september", "october","november", "december")
for (j in year){
  news.count3 <- subset(news.count3, news.count3$word != j)
}

#Keep top 10 TFIDF by group
news.count.top3 <- news.count3 %>%
  group_by(date) %>%
  top_n(n = 10, wt = tf_idf)
#Create Document Term Matrix
news.matrix3 <- news.count.top3 %>% cast_dtm(date, word, n)

#LDA
library(topicmodels)
library(ggplot2)

##LDA: Latent Dirichlet Allocaiton
#Run LDA
tal_lda3 <- LDA(news.matrix3, k = 6, control = list(seed = 1234))
tal_top3 <- tidy(tal_lda3, matrix = "beta")

#
tal_top_terms3 <- tal_top3 %>%
  group_by(topic) %>%
  top_n(10, beta) %>%
  ungroup() %>%
  arrange(topic, -beta)

tal_top_terms3 %>%
  mutate(term = reorder(term, beta)) %>%
  ggplot(aes(term, beta, fill = factor(topic))) +
  geom_col(show.legend = FALSE) + 
  theme(text = element_text(size=10)) +
  facet_wrap(~ topic, scales = "free") +
  coord_flip()


#######################
#Topic Modeling in 2017
week <- c("monday","tuesday","wednesday","thursday","friday","saturday","sunday")
for (i in week){
  news.count4 <- subset(news.count4, news.count4$word != i)
}

year <- c("jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "sept", "oct",
          "nov", "dec", "january", "february", "march", "april", "may", "june",
          "july", "august", "september", "october","november", "december")
for (j in year){
  news.count4 <- subset(news.count4, news.count4$word != j)
}

#Keep top 10 TFIDF by group
news.count.top4 <- news.count4 %>%
  group_by(date) %>%
  top_n(n = 10, wt = tf_idf)
#Create Document Term Matrix
news.matrix4 <- news.count.top4 %>% cast_dtm(date, word, n)

#LDA
library(topicmodels)
library(ggplot2)

##LDA: Latent Dirichlet Allocaiton
#Run LDA
tal_lda4 <- LDA(news.matrix4, k = 6, control = list(seed = 1234))
tal_top4 <- tidy(tal_lda4, matrix = "beta")

#
tal_top_terms4 <- tal_top4 %>%
  group_by(topic) %>%
  top_n(10, beta) %>%
  ungroup() %>%
  arrange(topic, -beta)

tal_top_terms4 %>%
  mutate(term = reorder(term, beta)) %>%
  ggplot(aes(term, beta, fill = factor(topic))) +
  geom_col(show.legend = FALSE) + 
  theme(text = element_text(size=10)) +
  facet_wrap(~ topic, scales = "free") +
  coord_flip()


WordCloud
The word cloud shows the key words that have the highest frequency from 2014 to 2017.

#############
##Wordcloud##
#############
#Wordcloud all news key words from 2014-17
library(RColorBrewer)
library(wordcloud)

# Calculate Frequency
#uniwords <- unique(news.count$word)

#WordCloud2014-2017
news.word <- aggregate(news.count$n, by = list(date = news.count$word), FUN = length)
colnames(news.word) <- c("word", "frequency")

# Use worldcloud to scale each reason
wordcloud(news.word$word, 100 * news.word$frequency,
          min.freq = 1000, max.words = Inf,
          colors = c("red", "yellow", "blue", "orange", "dark blue"),
          random.color = T)
